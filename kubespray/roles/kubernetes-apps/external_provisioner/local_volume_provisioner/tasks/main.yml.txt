[0].name = Local Volume Provisioner | Ensure base dir is created on all hosts
[0].include_tasks = basedirs.yml
[0].loop_control.loop_var = delegate_host_base_dir
[0].loop = {{ groups['k8s_cluster'] | product(local_volume_provisioner_storage_classes.keys()) | list }}
[1].name = Local Volume Provisioner | Create addon dir
[1].file.path = {{ kube_config_dir }}/addons/local_volume_provisioner
[1].file.state = directory
[1].file.owner = root
[1].file.group = root
[1].file.mode = 0755
[2].name = Local Volume Provisioner | Templates list
[2].set_fact.local_volume_provisioner_templates[0].name = local-volume-provisioner-ns
[2].set_fact.local_volume_provisioner_templates[0].file = local-volume-provisioner-ns.yml
[2].set_fact.local_volume_provisioner_templates[0].type = ns
[2].set_fact.local_volume_provisioner_templates[1].name = local-volume-provisioner-sa
[2].set_fact.local_volume_provisioner_templates[1].file = local-volume-provisioner-sa.yml
[2].set_fact.local_volume_provisioner_templates[1].type = sa
[2].set_fact.local_volume_provisioner_templates[2].name = local-volume-provisioner-clusterrole
[2].set_fact.local_volume_provisioner_templates[2].file = local-volume-provisioner-clusterrole.yml
[2].set_fact.local_volume_provisioner_templates[2].type = clusterrole
[2].set_fact.local_volume_provisioner_templates[3].name = local-volume-provisioner-clusterrolebinding
[2].set_fact.local_volume_provisioner_templates[3].file = local-volume-provisioner-clusterrolebinding.yml
[2].set_fact.local_volume_provisioner_templates[3].type = clusterrolebinding
[2].set_fact.local_volume_provisioner_templates[4].name = local-volume-provisioner-cm
[2].set_fact.local_volume_provisioner_templates[4].file = local-volume-provisioner-cm.yml
[2].set_fact.local_volume_provisioner_templates[4].type = cm
[2].set_fact.local_volume_provisioner_templates[5].name = local-volume-provisioner-ds
[2].set_fact.local_volume_provisioner_templates[5].file = local-volume-provisioner-ds.yml
[2].set_fact.local_volume_provisioner_templates[5].type = ds
[2].set_fact.local_volume_provisioner_templates[6].name = local-volume-provisioner-sc
[2].set_fact.local_volume_provisioner_templates[6].file = local-volume-provisioner-sc.yml
[2].set_fact.local_volume_provisioner_templates[6].type = sc
[3].name = Local Volume Provisioner | Create manifests
[3].template.src = {{ item.file }}.j2
[3].template.dest = {{ kube_config_dir }}/addons/local_volume_provisioner/{{ item.file }}
[3].template.mode = 0644
[3].with_items = {{ local_volume_provisioner_templates }}
[3].register = local_volume_provisioner_manifests
[3].when = inventory_hostname == groups['kube_control_plane'][0]
[4].name = Local Volume Provisioner | Apply manifests
[4].kube.name = {{ item.item.name }}
[4].kube.namespace = {{ local_volume_provisioner_namespace }}
[4].kube.kubectl = {{ bin_dir }}/kubectl
[4].kube.resource = {{ item.item.type }}
[4].kube.filename = {{ kube_config_dir }}/addons/local_volume_provisioner/{{ item.item.file }}
[4].kube.state = latest
[4].with_items = {{ local_volume_provisioner_manifests.results }}
[4].when = inventory_hostname == groups['kube_control_plane'][0]
[4].loop_control.label = {{ item.item.file }}
