~d0.name = Import DebOps global handlers
~d1.ansible.builtin.import_role = 
~d2.name = 'global_handlers'
~d0.name = Import DebOps secret role
~d1.ansible.builtin.import_role = 
~d2.name = 'secret'
~d0.name = Refresh APT cache when needed
~d1.ansible.builtin.apt = 
~d2.update_cache = True
~d2.cache_valid_time = '{{ debconf__cache_valid_time }}'
~d1.register = debconf__register_apt_update
~d1.until = debconf__register_apt_update is succeeded
~d0.name = Install debconf module dependencies
~d1.ansible.builtin.apt = 
~d2.name = [ 'debconf', 'debconf-utils' ]
~d2.state = 'present'
~d1.register = debconf__register_debconf_packages
~d1.until = debconf__register_debconf_packages is succeeded
~d0.name = Apply requested package configuration in debconf
~d1.ansible.builtin.debconf = 
~d2.name = '{{ item.name }}'
~d2.question = '{{ item.question | d(omit) }}'
~d2.unseen = '{{ item.unseen | d(omit) }}'
~d2.value = '{{ item.value | d(omit) }}'
~d2.vtype = '{{ item.vtype | d(omit) }}'
~d1.loop = '{{ debconf__filtered_entries }}'
~d1.register = debconf__register_entries
~d1.when = item.state | d('present') not in [ 'init', 'ignore' ]
~d1.no_log = '{{ debops__no_log | d(True
~d0.name = Detect packages which need to be reconfigured
~d1.ansible.builtin.set_fact = 
~d2.debconf__fact_reconfigure_packages = '{{ lookup("template", "lookup/debconf__fact_reconfigure_packages.j2",
~d0.name = Install requested APT packages
~d1.ansible.builtin.apt = 
~d2.name = '{{ q("flattened", debconf__packages
~d2.state = '{{ debconf__apt_state }}'
~d1.register = debconf__register_packages
~d1.until = debconf__register_packages is succeeded
~d0.name = Reconfigure packages using debconf
~d1.ansible.builtin.command = 'dpkg-reconfigure --frontend noninteractive {{ item }}'
~d1.loop = '{{ debconf__fact_reconfigure_packages }}'
~d1.register = debconf__register_reconfigure
~d1.when = item is defined
~d1.changed_when = debconf__register_reconfigure.rc == 0
~d0.name = Configure alternative symlinks
~d1.community.general.alternatives = 
~d2.name = '{{ item.name }}'
~d2.path = '{{ item.path }}'
~d2.link = '{{ item.link | d(omit) }}'
~d2.priority = '{{ item.priority | d(omit) }}'
~d1.loop = '{{ q("flattened", debconf__default_alternatives
~d1.when = item.name | d() and item.path | d()
~d0.name = Configure automatic alternatives
~d1.ansible.builtin.command = update-alternatives --auto {{ item.name }}
~d1.register = debconf__register_alternatives
~d1.loop = '{{ q("flattened", debconf__alternatives
~d1.when = item.name | d() and not item.path | d()
~d1.changed_when = debconf__register_alternatives.stdout | d()
~d0.name = Execute shell commands
~d1.ansible.builtin.include_tasks = 'shell_commands.yml'
~d1.loop = '{{ q("flattened", debconf__combined_commands) | debops.debops.parse_kv_items }}'
~d1.loop_control = 
~d2.label = '{{ {"name": item.name} }}'
~d1.when = item.name | d() and item.state | d('present') not in [ 'absent', 'ignore' ]
~d1.no_log = '{{ debops__no_log | d(item.no_log) | d(False) }}'
~d1.tags = [ 'role::debconf:commands' ]
