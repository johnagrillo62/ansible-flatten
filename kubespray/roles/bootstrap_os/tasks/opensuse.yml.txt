[0].name = Gather host facts to get ansible_distribution_version ansible_distribution_major_version
[0].setup.gather_subset = !all
[0].setup.filter = ansible_distribution_*version
[1].name = Check that /etc/sysconfig/proxy file exists
[1].stat.path = /etc/sysconfig/proxy
[1].stat.get_attributes = false
[1].stat.get_checksum = false
[1].stat.get_mime = false
[1].register = stat_result
[2].name = Create the /etc/sysconfig/proxy empty file
[2].file.path = /etc/sysconfig/proxy
[2].file.state = touch
[2].when[0] = http_proxy is defined or https_proxy is defined
[2].when[1] = not stat_result.stat.exists
[3].name = Set the http_proxy in /etc/sysconfig/proxy
[3].lineinfile.path = /etc/sysconfig/proxy
[3].lineinfile.regexp = ^HTTP_PROXY=
[3].lineinfile.line = HTTP_PROXY="{{ http_proxy }}"
[3].become = true
[3].when[0] = http_proxy is defined
[4].name = Set the https_proxy in /etc/sysconfig/proxy
[4].lineinfile.path = /etc/sysconfig/proxy
[4].lineinfile.regexp = ^HTTPS_PROXY=
[4].lineinfile.line = HTTPS_PROXY="{{ https_proxy }}"
[4].become = true
[4].when[0] = https_proxy is defined
[5].name = Enable proxies
[5].lineinfile.path = /etc/sysconfig/proxy
[5].lineinfile.regexp = ^PROXY_ENABLED=
[5].lineinfile.line = PROXY_ENABLED="yes"
[5].become = true
[5].when[0] = http_proxy is defined or https_proxy is defined
[6].name = Install python-xml
[6].shell = zypper refresh && zypper --non-interactive install python-xml
[6].changed_when = false
[6].become = true
[6].tags[0] = facts
