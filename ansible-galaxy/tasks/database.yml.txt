~d0.name = Manage Galaxy database
~d1.block = 
~d2.name = Get current Galaxy DB version
~d3.command = "{{ galaxy_venv_dir }}/bin/python {{ galaxy_server_dir }}/scripts/manage_db.py -c {{ galaxy_config_file }} db_version"
~d3.args = 
~d4.chdir = "{{ galaxy_server_dir }}"
~d3.register = current_db_version
~d3.changed_when = no
~d3.failed_when = 
~d3.when = not ansible_check_mode
~d2.name = Get maximum Galaxy DB version
~d3.command = "{{ galaxy_venv_dir }}/bin/python {{ galaxy_server_dir }}/scripts/manage_db.py -c {{ galaxy_config_file }} version"
~d3.args = 
~d4.chdir = "{{ galaxy_server_dir }}"
~d3.register = max_db_version
~d3.changed_when = no
~d3.when = not ansible_check_mode
~d2.name = Report current and max Galaxy database
~d3.debug = 
~d4.msg = "Current database version is {{ current_db_version.stdout }} and the maximum version is {{ max_db_version.stdout }}."
~d3.changed_when = True
~d3.when = 
~d2.name = Upgrade Galaxy DB
~d3.command = "{{ galaxy_venv_dir }}/bin/python {{ galaxy_server_dir }}/scripts/manage_db.py -c {{ galaxy_config_file }} upgrade"
~d3.args = 
~d4.chdir = "{{ galaxy_server_dir }}"
~d3.when = 
~d1.remote_user = "{{ galaxy_remote_users.galaxy | default(__galaxy_remote_user) }}"
~d1.become = "{{ true if galaxy_become_users.galaxy is defined else __galaxy_become }}"
~d1.become_user = "{{ galaxy_become_users.galaxy | default(__galaxy_become_user) }}"
