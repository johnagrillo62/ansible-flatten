[0].name = Include ansible_distribution vars
[0].include_vars.file = {{ ansible_distribution }}.yml
[0].tags = rabbitmq
[1].name = Configure RabbitMQ/RabbitMQ-erlang GPG keys in the RPM keyring
[1].tags = rabbitmq
[1].rpm_key.key = {{ sensu_rabbitmq_signing_key }}
[1].rpm_key.state = present
[1].register = sensu_rabbitmq_import_key
[2].name = Add RabbitMQ's repo
[2].tags = rabbitmq
[2].yum_repository.name = rabbitmq
[2].yum_repository.description = rabbitmq
[2].yum_repository.baseurl = {{ sensu_rabbitmq_baseurl }}
[2].yum_repository.gpgcheck = yes
[2].yum_repository.gpgkey = {{ sensu_rabbitmq_signing_key }}
[2].yum_repository.repo_gpgcheck = no
[3].name = Add RabbitMQ's Erlang repo
[3].tags = rabbitmq
[3].yum_repository.name = rabbitmq-erlang
[3].yum_repository.description = rabbitmq-erlang
[3].yum_repository.baseurl = {{ sensu_rabbitmq_erlang_baseurl }}
[3].yum_repository.gpgcheck = yes
[3].yum_repository.gpgkey = {{ sensu_rabbitmq_erlang_signing_key }}
[3].yum_repository.repo_gpgcheck = no
[4].name = Make yum cache to import GPG keys
[4].tags = rabbitmq
[4].command = yum -q makecache -y --disablerepo='*' --enablerepo='{{ item }}'
[4].args.warn = false
[4].when = sensu_rabbitmq_import_key.changed
[4].loop[0] = rabbitmq
[4].loop[1] = rabbitmq-erlang
[5].name = Ensure socat is installed
[5].tags = rabbitmq
[5].yum.name = socat
[5].yum.state = present
[6].name = Ensure Erlang & RabbitMQ are installed
[6].tags = rabbitmq
[6].yum.name[0] = erlang
[6].yum.name[1] = rabbitmq-server
[6].yum.state = present
[6].yum.enablerepo = rabbitmq,rabbitmq-erlang
[6].yum.disablerepo = *
