[0].name = Import DebOps global handlers
[0]["ansible.builtin.import_role"].name = global_handlers
[1].name = Install required packages
[1]["ansible.builtin.apt"].name = {{ (docker_server__base_packages
               + docker_server__packages) | flatten }} 
[1]["ansible.builtin.apt"].state = present
[1]["ansible.builtin.apt"].install_recommends = False
[1].notify[0] = Refresh host facts
[1].register = docker_server__register_packages
[1].until = docker_server__register_packages is succeeded
[2].name = Add specified users to 'docker' group
[2]["ansible.builtin.user"].name = {{ item }}
[2]["ansible.builtin.user"].groups = docker
[2]["ansible.builtin.user"].append = True
[2].loop = {{ docker_server__admins }}
[2].tags[0] = role::docker_server:config
[2].tags[1] = role::docker_server:admins
[3].name = Make sure that Ansible local facts directory exists
[3]["ansible.builtin.file"].path = /etc/ansible/facts.d
[3]["ansible.builtin.file"].state = directory
[3]["ansible.builtin.file"].mode = 0755
[4].name = Save docker_server local facts
[4]["ansible.builtin.template"].src = etc/ansible/facts.d/docker_server.fact.j2
[4]["ansible.builtin.template"].dest = /etc/ansible/facts.d/docker_server.fact
[4]["ansible.builtin.template"].mode = 0755
[4].notify[0] = Refresh host facts
[4].tags[0] = meta::facts
[5].name = Update Ansible facts if they were modified
[5]["ansible.builtin.meta"] = flush_handlers
[6].name = Generate Docker configuration file
[6]["ansible.builtin.template"].src = etc/docker/daemon.json.j2
[6]["ansible.builtin.template"].dest = /etc/docker/daemon.json
[6]["ansible.builtin.template"].mode = 0644
[6].notify[0] = Restart docker
[6].tags[0] = role::docker_server:config
[7].name = Install ferm post hook
[7]["ansible.builtin.template"].src = etc/ferm/hooks/post.d/restart-docker.j2
[7]["ansible.builtin.template"].dest = /etc/ferm/hooks/post.d/restart-docker
[7]["ansible.builtin.template"].mode = 0755
[7].when = docker_server__ferm_post_hook | bool
[8].name = Create resolved.conf.d override directory
[8]["ansible.builtin.file"].path = /etc/systemd/resolved.conf.d
[8]["ansible.builtin.file"].state = directory
[8]["ansible.builtin.file"].mode = 0755
[8].when = docker_server__resolved_integration | bool
[9].name = Remove systemd-resolved integration
[9]["ansible.builtin.file"].path = /etc/systemd/resolved.conf.d/docker.conf
[9]["ansible.builtin.file"].state = absent
[9].notify[0] = Restart systemd-resolved service
[9].when = not docker_server__resolved_integration | bool
[10].name = Configure systemd-resolved integration
[10]["ansible.builtin.template"].src = etc/systemd/resolved.conf.d/docker.conf.j2
[10]["ansible.builtin.template"].dest = /etc/systemd/resolved.conf.d/docker.conf
[10]["ansible.builtin.template"].mode = 0644
[10].notify[0] = Restart systemd-resolved service
[10].when = docker_server__resolved_integration | bool
