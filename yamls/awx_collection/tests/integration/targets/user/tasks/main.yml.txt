[0].name = Generate a test ID
[0]["ansible.builtin.set_fact"].test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate names
[1]["ansible.builtin.set_fact"].username = AWX-Collection-tests-user-user-{{ test_id }}
[2].name = Create a User
[2]["awx.awx.user"].username = {{ username }}
[2]["awx.awx.user"].first_name = Joe
[2]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[2]["awx.awx.user"].state = present
[2].register = result
[3].name = Assert result changed
[3]["ansible.builtin.assert"].that[0] = result.changed
[4].name = Create a User with exists
[4]["awx.awx.user"].username = {{ username }}
[4]["awx.awx.user"].first_name = Joe
[4]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[4]["awx.awx.user"].state = exists
[4].register = result
[5].name = Assert results did not change
[5]["ansible.builtin.assert"].that[0] = not result.changed
[6].name = Delete a User
[6]["awx.awx.user"].username = {{ username }}
[6]["awx.awx.user"].first_name = Joe
[6]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[6]["awx.awx.user"].state = absent
[6].register = result
[7].name = Assert result changed
[7]["ansible.builtin.assert"].that[0] = result.changed
[8].name = Create a User with exists
[8]["awx.awx.user"].username = {{ username }}
[8]["awx.awx.user"].first_name = Joe
[8]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[8]["awx.awx.user"].state = exists
[8].register = result
[9].name = Assert result changed
[9]["ansible.builtin.assert"].that[0] = result.changed
[10].name = Change a User by ID
[10]["awx.awx.user"].username = {{ result.id }}
[10]["awx.awx.user"].last_name = User
[10]["awx.awx.user"].email = joe@example.org
[10]["awx.awx.user"].state = present
[10].register = result
[11].name = Assert result changed
[11]["ansible.builtin.assert"].that[0] = result.changed
[12].name = Check idempotency
[12]["awx.awx.user"].username = {{ username }}
[12]["awx.awx.user"].first_name = Joe
[12]["awx.awx.user"].last_name = User
[12].register = result
[13].name = Assert result did not change
[13]["ansible.builtin.assert"].that[0] = not (result.changed)
[14].name = Rename a User
[14]["awx.awx.user"].username = {{ username }}
[14]["awx.awx.user"].new_username = {{ username }}-renamed
[14]["awx.awx.user"].email = joe@example.org
[14].register = result
[15].name = Assert result changed
[15]["ansible.builtin.assert"].that[0] = result.changed
[16].name = Delete a User
[16]["awx.awx.user"].username = {{ username }}-renamed
[16]["awx.awx.user"].email = joe@example.org
[16]["awx.awx.user"].state = absent
[16].register = result
[17].name = Assert result changed
[17]["ansible.builtin.assert"].that[0] = result.changed
[18].name = Create an Auditor
[18]["awx.awx.user"].first_name = Joe
[18]["awx.awx.user"].last_name = Auditor
[18]["awx.awx.user"].username = {{ username }}
[18]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[18]["awx.awx.user"].email = joe@example.org
[18]["awx.awx.user"].state = present
[18]["awx.awx.user"].auditor = true
[18].register = result
[19].name = Assert result changed
[19]["ansible.builtin.assert"].that[0] = result.changed
[20].name = Delete an Auditor
[20]["awx.awx.user"].username = {{ username }}
[20]["awx.awx.user"].email = joe@example.org
[20]["awx.awx.user"].state = absent
[20].register = result
[21].name = Assert result changed
[21]["ansible.builtin.assert"].that[0] = result.changed
[22].name = Create a Superuser
[22]["awx.awx.user"].first_name = Joe
[22]["awx.awx.user"].last_name = Super
[22]["awx.awx.user"].username = {{ username }}
[22]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[22]["awx.awx.user"].email = joe@example.org
[22]["awx.awx.user"].state = present
[22]["awx.awx.user"].superuser = true
[22].register = result
[23].name = Assert result changed
[23]["ansible.builtin.assert"].that[0] = result.changed
[24].name = Delete a Superuser
[24]["awx.awx.user"].username = {{ username }}
[24]["awx.awx.user"].email = joe@example.org
[24]["awx.awx.user"].state = absent
[24].register = result
[25].name = Assert result changed
[25]["ansible.builtin.assert"].that[0] = result.changed
[26].name = Test SSL parameter
[26]["awx.awx.user"].first_name = Joe
[26]["awx.awx.user"].last_name = User
[26]["awx.awx.user"].username = {{ username }}
[26]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[26]["awx.awx.user"].email = joe@example.org
[26]["awx.awx.user"].state = present
[26]["awx.awx.user"].validate_certs = true
[26]["awx.awx.user"].controller_host = http://foo.invalid
[26].ignore_errors = true
[26].register = result
[27].name = Assert SSL parameter failure message is meaningful
[27]["ansible.builtin.assert"].that[0] = result is failed or result.failed | default(false)
[28].name = Org tasks
[28].block[0].name = Generate an org name
[28].block[0]["ansible.builtin.set_fact"].org_name = AWX-Collection-tests-organization-org-{{ test_id }}
[28].block[1].name = Make sure organization is absent
[28].block[1].organization.name = {{ org_name }}
[28].block[1].organization.state = absent
[28].block[1].register = result
[28].block[2].name = Create a new Organization
[28].block[2].organization.name = {{ org_name }}
[28].block[2].organization.galaxy_credentials[0] = Ansible Galaxy
[28].block[2].register = result
[28].block[3].name = Assert result changed
[28].block[3]["ansible.builtin.assert"].that = result.changed
[28].block[4].name = Create a User to become admin of an organization
[28].block[4]["awx.awx.user"].username = {{ username }}-orgadmin
[28].block[4]["awx.awx.user"].password = {{ username }}-orgadmin
[28].block[4]["awx.awx.user"].state = present
[28].block[4]["awx.awx.user"].organization = {{ org_name }}
[28].block[4].register = result
[28].block[5].name = Assert result changed
[28].block[5]["ansible.builtin.assert"].that[0] = result.changed
[28].block[6].name = Add the user -orgadmin as an admin of the organization
[28].block[6]["awx.awx.role"].user = {{ username }}-orgadmin
[28].block[6]["awx.awx.role"].role = admin
[28].block[6]["awx.awx.role"].organization = {{ org_name }}
[28].block[6]["awx.awx.role"].state = present
[28].block[6].register = result
[28].block[7].name = Assert that user was added as org admin
[28].block[7]["ansible.builtin.assert"].that[0] = result.changed | default(false)
[28].block[8].name = Create a User as -orgadmin without using an organization (must fail)
[28].block[8]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[8]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[8]["awx.awx.user"].username = {{ username }}
[28].block[8]["awx.awx.user"].first_name = Joe
[28].block[8]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[28].block[8]["awx.awx.user"].state = present
[28].block[8].register = result
[28].block[8].ignore_errors = true
[28].block[9].name = Assert result failed
[28].block[9]["ansible.builtin.assert"].that[0] = result is defined
[28].block[9]["ansible.builtin.assert"].that[1] = result.failed is defined
[28].block[9]["ansible.builtin.assert"].that[2] = result.failed | bool
[28].block[9]["ansible.builtin.assert"].fail_msg = The task did not fail as expected.
[28].block[9]["ansible.builtin.assert"].success_msg = The task failed as expected.
[28].block[10].name = Create a User as -orgadmin using an organization
[28].block[10]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[10]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[10]["awx.awx.user"].username = {{ username }}
[28].block[10]["awx.awx.user"].first_name = Joe
[28].block[10]["awx.awx.user"].password = {{ 65535 | random | to_uuid }}
[28].block[10]["awx.awx.user"].state = present
[28].block[10]["awx.awx.user"].organization = {{ org_name }}
[28].block[10].register = result
[28].block[11].name = Assert result changed
[28].block[11]["ansible.builtin.assert"].that[0] = result.changed
[28].block[12].name = Change a User as -orgadmin by ID using an organization
[28].block[12]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[12]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[12]["awx.awx.user"].username = {{ result.id }}
[28].block[12]["awx.awx.user"].last_name = User
[28].block[12]["awx.awx.user"].email = joe@example.org
[28].block[12]["awx.awx.user"].state = present
[28].block[12]["awx.awx.user"].organization = {{ org_name }}
[28].block[12].register = result
[28].block[13].name = Assert result changed
[28].block[13]["ansible.builtin.assert"].that[0] = result.changed
[28].block[14].name = Check idempotency as -orgadmin using an organization
[28].block[14]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[14]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[14]["awx.awx.user"].username = {{ username }}
[28].block[14]["awx.awx.user"].first_name = Joe
[28].block[14]["awx.awx.user"].last_name = User
[28].block[14]["awx.awx.user"].organization = {{ org_name }}
[28].block[14].register = result
[28].block[15].name = Assert result did not change
[28].block[15]["ansible.builtin.assert"].that[0] = not (result.changed)
[28].block[16].name = Rename a User as -orgadmin using an organization
[28].block[16]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[16]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[16]["awx.awx.user"].username = {{ username }}
[28].block[16]["awx.awx.user"].new_username = {{ username }}-renamed
[28].block[16]["awx.awx.user"].email = joe@example.org
[28].block[16]["awx.awx.user"].organization = {{ org_name }}
[28].block[16].register = result
[28].block[17].name = Assert result changed
[28].block[17]["ansible.builtin.assert"].that[0] = result.changed
[28].block[18].name = Delete a User as -orgadmin using an organization
[28].block[18]["awx.awx.user"].controller_username = {{ username }}-orgadmin
[28].block[18]["awx.awx.user"].controller_password = {{ username }}-orgadmin
[28].block[18]["awx.awx.user"].username = {{ username }}-renamed
[28].block[18]["awx.awx.user"].email = joe@example.org
[28].block[18]["awx.awx.user"].state = absent
[28].block[18]["awx.awx.user"].organization = {{ org_name }}
[28].block[18].register = result
[28].block[19].name = Assert result changed
[28].block[19]["ansible.builtin.assert"].that[0] = result.changed
[28].block[20].name = Remove the user -orgadmin as an admin of the organization
[28].block[20].role.user = {{ username }}-orgadmin
[28].block[20].role.role = admin
[28].block[20].role.organization = {{ org_name }}
[28].block[20].role.state = absent
[28].block[20].register = result
[28].block[21].name = Assert result changed
[28].block[21]["ansible.builtin.assert"].that[0] = result.changed
[28].block[22].name = Delete the User -orgadmin
[28].block[22]["awx.awx.user"].username = {{ username }}-orgadmin
[28].block[22]["awx.awx.user"].password = {{ username }}-orgadmin
[28].block[22]["awx.awx.user"].state = absent
[28].block[22]["awx.awx.user"].organization = {{ org_name }}
[28].block[22].register = result
[28].block[23].name = Assert result changed
[28].block[23]["ansible.builtin.assert"].that[0] = result.changed
[28].block[24].name = Delete the Organization {{ org_name }}
[28].block[24].organization.name = {{ org_name }}
[28].block[24].organization.state = absent
[28].block[24].register = result
[28].block[25].name = Assert result changed
[28].block[25]["ansible.builtin.assert"].that = result.changed
