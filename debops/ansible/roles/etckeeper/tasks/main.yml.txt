~d0.name = Import custom Ansible plugins
~d1.ansible.builtin.import_role = 
~d2.name = 'ansible_plugins'
~d0.name = Import DebOps global handlers
~d1.ansible.builtin.import_role = 
~d2.name = 'global_handlers'
~d0.name = Make sure that Ansible local facts directory exists
~d1.ansible.builtin.file = 
~d2.path = '/etc/ansible/facts.d'
~d2.state = 'directory'
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0755'
~d0.name = Save etckeeper local facts
~d1.ansible.builtin.template = 
~d2.src = 'etc/ansible/facts.d/etckeeper.fact.j2'
~d2.dest = '/etc/ansible/facts.d/etckeeper.fact'
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0755'
~d1.notify = [ 'Refresh host facts' ]
~d1.tags = [ 'meta::facts' ]
~d0.name = Update Ansible facts if they were modified
~d1.ansible.builtin.meta = 'flush_handlers'
~d0.name = Divert original configuration under /etc
~d1.debops.debops.dpkg_divert = 
~d2.path = '/etc/etckeeper/etckeeper.conf'
~d1.when = etckeeper__enabled | bool and ansible_pkg_mgr == 'apt'
~d0.name = Install required packages
~d1.ansible.builtin.package = 
~d2.name = '{{ q("flattened", (etckeeper__base_packages
~d2.state = 'present'
~d1.register = etckeeper__register_packages
~d1.until = etckeeper__register_packages is succeeded
~d1.when = etckeeper__enabled | bool
~d0.name = Create etckeeper configuration
~d1.ansible.builtin.template = 
~d2.src = 'etc/etckeeper/etckeeper.conf.j2'
~d2.dest = '/etc/etckeeper/etckeeper.conf'
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0644'
~d1.register = etckeeper__register_config
~d1.notify = [ 'Commit changes in etckeeper' ]
~d1.when = etckeeper__enabled | bool
~d0.name = Initialize VCS in /etc
~d1.ansible.builtin.command = etckeeper init
~d1.args = 
~d2.creates = '/etc/.etckeeper'
~d1.register = etckeeper__register_init
~d1.notify = [ 'Commit changes in etckeeper' ]
~d1.when = etckeeper__enabled | bool
~d0.name = Manage entries in /etc/.gitignore
~d1.ansible.builtin.blockinfile = 
~d2.path = '/etc/.gitignore'
~d2.block = |
~d2.insertbefore = 'BOF'
~d2.marker = '{{ etckeeper__block_marker }}'
~d2.create = True
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0600'
~d1.register = etckeeper__register_gitignore
~d1.notify = [ 'Commit changes in etckeeper' ]
~d1.when = etckeeper__enabled | bool and etckeeper__vcs == 'git'
~d0.name = Install /etc/.gitattributes configuration
~d1.ansible.builtin.template = 
~d2.src = 'etc/gitattributes.j2'
~d2.dest = '/etc/.gitattributes'
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0644'
~d1.register = etckeeper__register_gitattributes
~d1.when = etckeeper__enabled | bool and etckeeper__vcs == 'git'
~d0.name = Set repository permissions
~d1.ansible.builtin.file = 
~d2.path = '/etc/.git'
~d2.state = 'directory'
~d2.owner = 'root'
~d2.group = '{{ etckeeper__repository_group | d("root") }}'
~d2.mode = '{{ etckeeper__repository_permissions | d("0700") }}'
~d1.when = etckeeper__enabled | bool and etckeeper__vcs == 'git'
~d0.name = Set user, email for the git repository
~d1.community.general.ini_file = 
~d2.dest = '/etc/.git/config'
~d2.section = 'user'
~d2.option = '{{ item.key }}'
~d2.value = '{{ item.value }}'
~d2.mode = '0644'
~d1.with_dict = 
~d2.name = '{{ etckeeper__vcs_user }}'
~d2.email = '{{ etckeeper__vcs_email }}'
~d1.when = etckeeper__enabled | bool and etckeeper__vcs == 'git' and
~d0.name = Remove e-mail notification hook script
~d1.ansible.builtin.file = 
~d2.path = '/etc/etckeeper/commit.d/99email'
~d2.state = 'absent'
~d1.when = etckeeper__enabled | bool and
~d0.name = Install e-mail notification hook script
~d1.ansible.builtin.template = 
~d2.src = 'etc/etckeeper/commit.d/99email.j2'
~d2.dest = '/etc/etckeeper/commit.d/99email'
~d2.owner = 'root'
~d2.group = 'root'
~d2.mode = '0755'
~d1.notify = [ 'Commit changes in etckeeper' ]
~d1.when = etckeeper__enabled | bool and
~d0.name = Configure other VCS software
~d1.ansible.builtin.include_tasks = 'other_vcs.yml'
~d1.when = etckeeper__enabled | bool and etckeeper__vcs != 'git' and
~d0.name = Unstage and remove ignored files from Git index
~d1.ansible.builtin.shell = set -o nounset -o pipefail -o errexit &&
~d1.args = 
~d2.executable = 'bash'
~d1.register = etckeeper__register_git_rm_cached_ignored_files
~d1.when = 
~d1.changed_when = etckeeper__register_git_rm_cached_ignored_files.stdout
~d0.name = Commit changes in configuration
~d1.ansible.builtin.command = etckeeper commit '{{ etckeeper__commit_message_update
~d1.register = etckeeper__register_commit
~d1.changed_when = etckeeper__register_commit.changed | bool
~d1.when = (etckeeper__enabled | bool and
