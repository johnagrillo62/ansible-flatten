[0].name = Generate a test ID
[0].set_fact.test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate names
[1].set_fact.jt_name1 = AWX-Collection-tests-job_launch-jt1-{{ test_id }}
[1].set_fact.jt_name2 = AWX-Collection-tests-job_launch-jt2-{{ test_id }}
[1].set_fact.proj_name = AWX-Collection-tests-job_launch-project-{{ test_id }}
[2].name = Launch a Job Template
[2].job_launch.job_template = Demo Job Template
[2].register = result
[3].assert.that[0] = result is changed
[3].assert.that[1] = result.status == 'pending'
[4].name = Wait for a job template to complete
[4].job_wait.job_id = {{ result.id }}
[4].job_wait.interval = 10
[4].job_wait.timeout = 120
[4].register = result
[5].assert.that[0] = result is not changed
[5].assert.that[1] = result.status == 'successful'
[6].name = Check module fails with correct msg
[6].job_launch.job_template = Non_Existing_Job_Template
[6].job_launch.inventory = Demo Inventory
[6].register = result
[6].ignore_errors = yes
[7].assert.that[0] = result is failed
[7].assert.that[1] = result is not changed
[7].assert.that[2] = 'Non_Existing_Job_Template' in result.msg
[8].name = Create a Job Template for testing prompt on launch
[8].job_template.name = {{ jt_name1 }}
[8].job_template.project = Demo Project
[8].job_template.playbook = hello_world.yml
[8].job_template.job_type = run
[8].job_template.ask_credential = true
[8].job_template.ask_inventory = true
[8].job_template.ask_tags_on_launch = true
[8].job_template.ask_skip_tags_on_launch = true
[8].job_template.state = present
[8].register = result
[9].name = Launch job template with inventory and credential for prompt on launch
[9].job_launch.job_template = {{ jt_name1 }}
[9].job_launch.inventory = Demo Inventory
[9].job_launch.credential = Demo Credential
[9].job_launch.tags[0] = sometimes
[9].job_launch.skip_tags[0] = always
[9].register = result
[10].assert.that[0] = result is changed
[10].assert.that[1] = result.status == 'pending'
[11].name = Create a project for testing extra_vars
[11].project.name = {{ proj_name }}
[11].project.organization = Default
[11].project.scm_type = git
[11].project.scm_url = https://github.com/ansible/test-playbooks
[12].name = Create the job template with survey
[12].job_template.name = {{ jt_name2 }}
[12].job_template.project = {{ proj_name }}
[12].job_template.playbook = debug.yml
[12].job_template.job_type = run
[12].job_template.state = present
[12].job_template.inventory = Demo Inventory
[12].job_template.survey_enabled = true
[12].job_template.ask_variables_on_launch = false
[12].job_template.survey_spec.name = 
[12].job_template.survey_spec.description = 
[12].job_template.survey_spec.spec[0].question_name = Basic Name
[12].job_template.survey_spec.spec[0].question_description = Name
[12].job_template.survey_spec.spec[0].required = true
[12].job_template.survey_spec.spec[0].type = text
[12].job_template.survey_spec.spec[0].variable = basic_name
[12].job_template.survey_spec.spec[0].min = 0
[12].job_template.survey_spec.spec[0].max = 1024
[12].job_template.survey_spec.spec[0].default = 
[12].job_template.survey_spec.spec[0].choices = 
[12].job_template.survey_spec.spec[0].new_question = true
[12].job_template.survey_spec.spec[1].question_name = Choose yes or no?
[12].job_template.survey_spec.spec[1].question_description = Choosing yes or no.
[12].job_template.survey_spec.spec[1].required = false
[12].job_template.survey_spec.spec[1].type = multiplechoice
[12].job_template.survey_spec.spec[1].variable = option_true_false
[12].job_template.survey_spec.spec[1].min = null
[12].job_template.survey_spec.spec[1].max = null
[12].job_template.survey_spec.spec[1].default = yes
[12].job_template.survey_spec.spec[1].choices = yes
no
[12].job_template.survey_spec.spec[1].new_question = true
[13].name = Kick off a job template with survey
[13].job_launch.job_template = {{ jt_name2 }}
[13].job_launch.extra_vars.basic_name = My First Variable
[13].job_launch.extra_vars.option_true_false = no
[13].ignore_errors = yes
[13].register = result
[14].assert.that[0] = result is not failed
[15].name = Prompt the job templates extra_vars on launch
[15].job_template.name = {{ jt_name2 }}
[15].job_template.state = present
[15].job_template.ask_variables_on_launch = true
[16].name = Kick off a job template with extra_vars
[16].job_launch.job_template = {{ jt_name2 }}
[16].job_launch.extra_vars.basic_name = My First Variable
[16].job_launch.extra_vars.var1 = My First Variable
[16].job_launch.extra_vars.var2 = My Second Variable
[16].ignore_errors = yes
[16].register = result
[17].assert.that[0] = result is not failed
[18].name = Create a Job Template for testing extra_vars
[18].job_template.name = {{ jt_name2 }}
[18].job_template.project = {{ proj_name }}
[18].job_template.playbook = debug.yml
[18].job_template.job_type = run
[18].job_template.survey_enabled = false
[18].job_template.state = present
[18].job_template.inventory = Demo Inventory
[18].job_template.extra_vars.foo = bar
[18].register = result
[19].name = Launch job template with inventory and credential for prompt on launch
[19].job_launch.job_template = {{ jt_name2 }}
[19].job_launch.organization = Default
[19].register = result
[20].assert.that[0] = result is changed
[21].name = Wait for a job template to complete
[21].job_wait.job_id = {{ result.id }}
[21].job_wait.interval = 10
[21].job_wait.timeout = 120
[21].register = result
[22].assert.that[0] = result is not changed
[22].assert.that[1] = result.status == 'successful'
[23].name = Get the job
[23].job_list.query.id = {{result.id}}
[23].register = result
[24].assert.that[0] = {"foo": "bar"} | to_json in result.results[0].extra_vars
[25].name = Delete the first jt
[25].job_template.name = {{ jt_name1 }}
[25].job_template.project = Demo Project
[25].job_template.playbook = hello_world.yml
[25].job_template.state = absent
[25].register = result
[26].assert.that[0] = result is changed
[27].name = Delete the second jt
[27].job_template.name = {{ jt_name2 }}
[27].job_template.project = {{ proj_name }}
[27].job_template.playbook = debug.yml
[27].job_template.state = absent
[27].register = result
[28].assert.that[0] = result is changed
[29].name = Delete the extra_vars project
[29].project.name = {{ proj_name }}
[29].project.organization = Default
[29].project.state = absent
[29].register = result
[30].assert.that[0] = result is changed
