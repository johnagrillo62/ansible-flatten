[0].name = Generate a test ID
[0].set_fact.test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate names
[1].set_fact.inv_name1 = AWX-Collection-tests-inventory-inv1-{{ test_id }}
[1].set_fact.inv_name2 = AWX-Collection-tests-inventory-inv2-{{ test_id }}
[1].set_fact.group_name1 = AWX-Collection-tests-instance_group-group1-{{ test_id }}
[2].block[0].name = Create an Instance Group
[2].block[0].instance_group.name = {{ group_name1 }}
[2].block[0].instance_group.state = present
[2].block[0].register = result
[2].block[1].assert.that[0] = result is changed
[2].block[2].name = Create an Inventory
[2].block[2].inventory.name = {{ inv_name1 }}
[2].block[2].inventory.organization = Default
[2].block[2].inventory.instance_groups[0] = {{ group_name1 }}
[2].block[2].inventory.state = present
[2].block[2].register = result
[2].block[3].assert.that[0] = result is changed
[2].block[4].name = Create an Inventory with exists
[2].block[4].inventory.name = {{ inv_name1 }}
[2].block[4].inventory.organization = Default
[2].block[4].inventory.instance_groups[0] = {{ group_name1 }}
[2].block[4].inventory.state = exists
[2].block[4].register = result
[2].block[5].assert.that[0] = result is not changed
[2].block[6].name = Delete an Inventory
[2].block[6].inventory.name = {{ inv_name1 }}
[2].block[6].inventory.organization = Default
[2].block[6].inventory.instance_groups[0] = {{ group_name1 }}
[2].block[6].inventory.state = absent
[2].block[6].register = result
[2].block[7].assert.that[0] = result is changed
[2].block[8].name = Create an Inventory with exists
[2].block[8].inventory.name = {{ inv_name1 }}
[2].block[8].inventory.organization = Default
[2].block[8].inventory.instance_groups[0] = {{ group_name1 }}
[2].block[8].inventory.state = exists
[2].block[8].register = result
[2].block[9].assert.that[0] = result is changed
[2].block[10].name = Test Inventory module idempotency
[2].block[10].inventory.name = {{ result.id }}
[2].block[10].inventory.organization = Default
[2].block[10].inventory.state = present
[2].block[10].register = result
[2].block[11].assert.that[0] = result is not changed
[2].block[12].name = Copy an inventory
[2].block[12].inventory.name = copy_{{ inv_name1 }}
[2].block[12].inventory.copy_from = {{ inv_name1 }}
[2].block[12].inventory.organization = Default
[2].block[12].inventory.description = Our Foo Cloud Servers
[2].block[12].inventory.state = present
[2].block[12].register = result
[2].block[13].assert.that[0] = result.copied
[2].block[14].name = Rename an inventory
[2].block[14].inventory.name = copy_{{ inv_name1 }}
[2].block[14].inventory.new_name = copy_{{ inv_name1 }}a
[2].block[14].inventory.organization = Default
[2].block[14].inventory.state = present
[2].block[14].register = result
[2].block[15].assert.that[0] = result.changed
[2].block[16].name = Delete an Inventory
[2].block[16].inventory.name = copy_{{ inv_name1 }}a
[2].block[16].inventory.organization = Default
[2].block[16].inventory.state = absent
[2].block[16].register = result
[2].block[17].assert.that[0] = result is changed
[2].block[18].name = Fail Change Regular to Smart
[2].block[18].inventory.name = {{ inv_name1 }}
[2].block[18].inventory.organization = Default
[2].block[18].inventory.kind = smart
[2].block[18].register = result
[2].block[18].ignore_errors = yes
[2].block[19].assert.that[0] = result is failed
[2].block[20].name = Create a smart inventory
[2].block[20].inventory.name = {{ inv_name2 }}
[2].block[20].inventory.organization = Default
[2].block[20].inventory.kind = smart
[2].block[20].inventory.host_filter = name=foo
[2].block[20].register = result
[2].block[21].assert.that[0] = result is changed
[2].block[22].name = Delete a smart inventory
[2].block[22].inventory.name = {{ inv_name2 }}
[2].block[22].inventory.organization = Default
[2].block[22].inventory.kind = smart
[2].block[22].inventory.host_filter = name=foo
[2].block[22].inventory.state = absent
[2].block[22].register = result
[2].block[23].assert.that[0] = result is changed
[2].block[24].name = Delete an Inventory
[2].block[24].inventory.name = {{ inv_name1 }}
[2].block[24].inventory.organization = Default
[2].block[24].inventory.state = absent
[2].block[24].register = result
[2].block[25].assert.that[0] = result is changed
[2].block[26].name = Delete a Non-Existent Inventory
[2].block[26].inventory.name = {{ inv_name1 }}
[2].block[26].inventory.organization = Default
[2].block[26].inventory.state = absent
[2].block[26].register = result
[2].block[27].assert.that[0] = result is not changed
[2].block[28].name = Check module fails with correct msg
[2].block[28].inventory.name = test-inventory
[2].block[28].inventory.description = Inventory Description
[2].block[28].inventory.organization = test-non-existing-org
[2].block[28].inventory.state = present
[2].block[28].register = result
[2].block[28].ignore_errors = yes
[2].block[29].assert.that[0] = result is failed
[2].block[29].assert.that[1] = result is not changed
[2].block[29].assert.that[2] = 'test-non-existing-org' in result.msg and 'returned 0 items, expected 1' in result.msg
[2].block[29].assert.that[3] = result.total_results == 0
[2].always[0].name = Delete Inventories
[2].always[0].inventory.name = {{ item }}
[2].always[0].inventory.organization = Default
[2].always[0].inventory.state = absent
[2].always[0].loop[0] = {{ inv_name1 }}
[2].always[0].loop[1] = {{ inv_name2 }}
[2].always[0].loop[2] = copy_{{ inv_name1 }}
[2].always[1].name = Delete the instance groups
[2].always[1].instance_group.name = {{ group_name1 }}
[2].always[1].instance_group.state = absent
