[0].name = Define dynamic groups
[0].import_playbook = ../../playbooks/boilerplate.yml
[1].name = Kubespray CI tests
[1].hosts = k8s_cluster
[1].gather_facts = false
[1].vars.testcase = {{ lookup('env', 'TESTCASE') }}
[1].tasks[0].name = Import Kubespray variables
[1].tasks[0].import_role.name = ../../roles/kubespray_defaults
[1].tasks[1].name = Testcases for apiserver
[1].tasks[1].import_tasks = 010_check-apiserver.yml
[1].tasks[1].when[0] = ('kube_control_plane') in group_names
[1].tasks[2].name = Test using API
[1].tasks[2].delegate_to = {{ groups['kube_control_plane'][0] }}
[1].tasks[2].run_once = true
[1].tasks[2].block[0].name = Testcases checking nodes
[1].tasks[2].block[0].import_tasks = 015_check-nodes-ready.yml
[1].tasks[2].block[1].name = Testcases checking pods
[1].tasks[2].block[1].import_tasks = 020_check-pods-running.yml
[1].tasks[2].block[1].when = ('macvlan' not in testcase)
[1].tasks[2].block[2].name = Testcases for network
[1].tasks[2].block[2].import_tasks = 030_check-network.yml
[1].tasks[2].block[2].when = ('macvlan' not in testcase)
[1].tasks[2].block[2].vars.test_image_repo = registry.k8s.io/e2e-test-images/agnhost
[1].tasks[2].block[2].vars.test_image_tag = 2.40
[1].tasks[3].name = Testcases for calico / advanced network
[1].tasks[3].import_tasks = 040_check-network-adv.yml
[1].tasks[3].when[0] = ('macvlan' not in testcase)
[1].tasks[3].when[1] = ('hardening' not in testcase)
[1].tasks[3].vars.agent_report_interval = 10
[1].tasks[3].vars.netcheck_namespace = default
[1].tasks[3].vars.netchecker_port = 31081
[1].tasks[4].name = Testcases for kubernetes conformance
[1].tasks[4].import_tasks = 100_check-k8s-conformance.yml
[1].tasks[4].delegate_to = {{ groups['kube_control_plane'][0] }}
[1].tasks[4].run_once = true
[1].tasks[4].when[0] = sonobuoy_enabled is defined
[1].tasks[4].when[1] = sonobuoy_enabled
[1].tasks[4].vars.sonobuoy_version = 0.57.3
[1].tasks[4].vars.sonobuoy_arch = amd64
[1].tasks[4].vars.sonobuoy_parallel = 30
[1].tasks[4].vars.sonobuoy_path = /usr/local/bin/sonobuoy
[1].tasks[4].vars.sonobuoy_mode = Quick
