[0].name = Import custom Ansible plugins
[0]["ansible.builtin.import_role"].name = ansible_plugins
[1].name = Import DebOps global handlers
[1]["ansible.builtin.import_role"].name = global_handlers
[2].name = Import DebOps secret role
[2]["ansible.builtin.import_role"].name = secret
[3].name = Ensure PowerDNS support is installed
[3]["ansible.builtin.package"].name = {{ (pdns__base_packages + pdns__packages) | flatten }}
[3]["ansible.builtin.package"].state = present
[3].register = pdns__register_packages
[3].until = pdns__register_packages is succeeded
[4].name = Configure PostgreSQL
[4]["ansible.builtin.include_tasks"] = init_postgresql.yml
[4].when = ('gpgsql' in pdns__backends)
[5].name = Divert original configuration
[5]["debops.debops.dpkg_divert"].path = /etc/powerdns/pdns.conf
[6].name = Make sure that Ansible local facts directory exists
[6]["ansible.builtin.file"].path = /etc/ansible/facts.d
[6]["ansible.builtin.file"].state = directory
[6]["ansible.builtin.file"].mode = 0755
[7].name = Save local facts
[7]["ansible.builtin.template"].src = etc/ansible/facts.d/pdns.fact.j2
[7]["ansible.builtin.template"].dest = /etc/ansible/facts.d/pdns.fact
[7]["ansible.builtin.template"].mode = 0755
[7].notify[0] = Refresh host facts
[7].tags[0] = meta::facts
[8].name = Update Ansible facts if they were modified
[8]["ansible.builtin.meta"] = flush_handlers
[9].name = Configure local PowerDNS changes
[9]["ansible.builtin.template"].src = etc/powerdns/pdns.conf.j2
[9]["ansible.builtin.template"].dest = /etc/powerdns/pdns.conf
[9]["ansible.builtin.template"].owner = root
[9]["ansible.builtin.template"].group = pdns
[9]["ansible.builtin.template"].mode = 0640
[9].notify[0] = Restart pdns
