[0].name = Import custom Ansible plugins
[0]["ansible.builtin.import_role"].name = ansible_plugins
[1].name = Import DebOps global handlers
[1]["ansible.builtin.import_role"].name = global_handlers
[2].name = Install required packages
[2]["ansible.builtin.package"].name = {{ q("flattened", (resolvconf__base_packages
                              + resolvconf__packages)) }}
[2]["ansible.builtin.package"].state = {{ resolvconf__deploy_state }}
[2].register = resolvconf__register_packages
[2].until = resolvconf__register_packages is succeeded
[2].when = (resolvconf__enabled | bool and resolvconf__deploy_state in ['present', 'absent'])
[3].name = Generate static configuration script
[3]["ansible.builtin.template"].src = usr/local/lib/resolvconf-static.j2
[3]["ansible.builtin.template"].dest = /usr/local/lib/resolvconf-static
[3]["ansible.builtin.template"].mode = 0755
[3].notify[0] = Apply static resolvconf configuration
[3].when = (resolvconf__enabled | bool and resolvconf__static_enabled | bool and resolvconf__deploy_state in ['present'])
[4].name = Create systemd override directory
[4]["ansible.builtin.file"].path = /etc/systemd/system/resolvconf.service.d
[4]["ansible.builtin.file"].state = directory
[4]["ansible.builtin.file"].mode = 0755
[4].when = (resolvconf__enabled | bool and resolvconf__static_enabled | bool and resolvconf__deploy_state in ['present'])
[5].name = Generate systemd service override
[5]["ansible.builtin.template"].src = etc/systemd/system/resolvconf.service.d/static.conf.j2
[5]["ansible.builtin.template"].dest = /etc/systemd/system/resolvconf.service.d/static.conf
[5]["ansible.builtin.template"].mode = 0644
[5].notify[0] = Reload service manager
[5].when = (resolvconf__enabled | bool and resolvconf__static_enabled | bool and resolvconf__deploy_state in ['present'])
[6].name = Add diversion of /etc/resolvconf/interface-order
[6]["debops.debops.dpkg_divert"].path = /etc/resolvconf/interface-order
[6]["debops.debops.dpkg_divert"].state = {{ resolvconf__deploy_state }}
[6]["debops.debops.dpkg_divert"].delete = True
[6].notify[0] = Refresh /etc/resolv.conf
[6].when = (resolvconf__enabled | bool and resolvconf__deploy_state in ['present'])
[7].name = Remove diversion of /etc/resolvconf/interface-order
[7]["debops.debops.dpkg_divert"].path = /etc/resolvconf/interface-order
[7]["debops.debops.dpkg_divert"].state = {{ resolvconf__deploy_state }}
[7]["debops.debops.dpkg_divert"].delete = True
[7].when = (resolvconf__enabled | bool and resolvconf__deploy_state in ['absent'])
[8].name = Generate /etc/resolvconf/interface-order configuration
[8]["ansible.builtin.template"].src = etc/resolvconf/interface-order.j2
[8]["ansible.builtin.template"].dest = /etc/resolvconf/interface-order
[8]["ansible.builtin.template"].mode = 0644
[8].notify[0] = Refresh /etc/resolv.conf
[8].when = resolvconf__enabled | bool and resolvconf__deploy_state == 'present'
[9].name = Remove configuration
[9]["ansible.builtin.file"].path = {{ item }}
[9]["ansible.builtin.file"].state = absent
[9].when = (resolvconf__enabled | bool and resolvconf__deploy_state in ['absent'])
[9].loop[0] = /usr/local/lib/resolvconf-static
[9].loop[1] = /etc/systemd/system/resolvconf.service.d/static.conf
[9].loop[2] = /etc/systemd/system/resolvconf.service.d
[10].name = Create static /etc/resolv.conf
[10]["ansible.builtin.copy"].mode = 0755
[10]["ansible.builtin.copy"].dest = /etc/resolv.conf
[10]["ansible.builtin.copy"].content = {{ resolvconf__static_content }}
[10].when = (resolvconf__enabled | bool and resolvconf__static_enabled | bool and resolvconf__static_content != '' and resolvconf__deploy_state != 'present')
[11].name = Make sure Ansible fact directory exists
[11]["ansible.builtin.file"].path = /etc/ansible/facts.d
[11]["ansible.builtin.file"].state = directory
[11]["ansible.builtin.file"].mode = 0755
[12].name = Generate resolvconf Ansible local facts
[12]["ansible.builtin.template"].src = etc/ansible/facts.d/resolvconf.fact.j2
[12]["ansible.builtin.template"].dest = /etc/ansible/facts.d/resolvconf.fact
[12]["ansible.builtin.template"].mode = 0755
[12].notify[0] = Refresh host facts
[12].tags[0] = meta::facts
[13].name = Reload facts if they were modified
[13]["ansible.builtin.meta"] = flush_handlers
