[0].name = Generate a random string for names
[0]["ansible.builtin.set_fact"].test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate random names for test objects
[1]["ansible.builtin.set_fact"].org_name = AWX-Collection-tests-organization-org-{{ test_id }}
[1]["ansible.builtin.set_fact"].scm_cred_name = AWX-Collection-tests-workflow_job_template-scm-cred-{{ test_id }}
[1]["ansible.builtin.set_fact"].demo_project_name = AWX-Collection-tests-workflow_job_template-proj-{{ test_id }}
[1]["ansible.builtin.set_fact"].demo_project_name_2 = AWX-Collection-tests-workflow_job_template-proj-{{ test_id }}_2
[1]["ansible.builtin.set_fact"].jt1_name = AWX-Collection-tests-workflow_job_template-jt1-{{ test_id }}
[1]["ansible.builtin.set_fact"].jt2_name = AWX-Collection-tests-workflow_job_template-jt2-{{ test_id }}
[1]["ansible.builtin.set_fact"].approval_node_name = AWX-Collection-tests-workflow_approval_node-{{ test_id }}
[1]["ansible.builtin.set_fact"].lab1 = AWX-Collection-tests-job_template-lab1-{{ test_id }}
[1]["ansible.builtin.set_fact"].wfjt_name = AWX-Collection-tests-workflow_job_template-wfjt-{{ test_id }}
[1]["ansible.builtin.set_fact"].webhook_wfjt_name = AWX-Collection-tests-workflow_job_template-webhook-wfjt-{{ test_id }}
[1]["ansible.builtin.set_fact"].email_not = AWX-Collection-tests-job_template-email-not-{{ test_id }}
[1]["ansible.builtin.set_fact"].webhook_notification = AWX-Collection-tests-notification_template-wehbook-not-{{ test_id }}
[1]["ansible.builtin.set_fact"].project_inv = AWX-Collection-tests-inventory_source-inv-project-{{ test_id }}
[1]["ansible.builtin.set_fact"].project_inv_source = AWX-Collection-tests-inventory_source-inv-source-project-{{ test_id }}
[1]["ansible.builtin.set_fact"].github_webhook_credential_name = AWX-Collection-tests-credential-webhook-{{ test_id }}_github
[1]["ansible.builtin.set_fact"].ee1 = AWX-Collection-tests-workflow_job_template-ee1-{{ test_id }}
[1]["ansible.builtin.set_fact"].label1 = AWX-Collection-tests-workflow_job_template-l1-{{ test_id }}
[1]["ansible.builtin.set_fact"].label2 = AWX-Collection-tests-workflow_job_template-l2-{{ test_id }}
[1]["ansible.builtin.set_fact"].ig1 = AWX-Collection-tests-workflow_job_template-ig1-{{ test_id }}
[1]["ansible.builtin.set_fact"].ig2 = AWX-Collection-tests-workflow_job_template-ig2-{{ test_id }}
[1]["ansible.builtin.set_fact"].host1 = AWX-Collection-tests-workflow_job_template-h1-{{ test_id }}
[2].name = Detect credential types
[2]["ansible.builtin.set_fact"].credentials = {{ lookup('awx.awx.controller_api', 'credential_types') }}
[3].name = Register Credentials found
[3]["ansible.builtin.set_fact"].github_found = {{ 'Github Personal Access Token' in credentials | map(attribute='name') | list }}
[3]["ansible.builtin.set_fact"].gitlab_found = {{ 'GitLab Personal Access Token' in credentials | map(attribute='name') | list }}
[4].name = Create initial resources for workflow job template tests
[4].block[0].name = Create a new organization
[4].block[0]["awx.awx.organization"].name = {{ org_name }}
[4].block[0]["awx.awx.organization"].galaxy_credentials[0] = Ansible Galaxy
[4].block[0].register = result
[4].block[1].name = Create SCM Credential
[4].block[1]["awx.awx.credential"].name = {{ scm_cred_name }}
[4].block[1]["awx.awx.credential"].organization = Default
[4].block[1]["awx.awx.credential"].credential_type = Source Control
[4].block[1].register = result
[4].block[2].name = Assert SCM credential created
[4].block[2]["ansible.builtin.assert"].that[0] = result.changed
[4].block[3].name = Create Github PAT Credential
[4].block[3]["awx.awx.credential"].name = {{ github_webhook_credential_name }}
[4].block[3]["awx.awx.credential"].organization = Default
[4].block[3]["awx.awx.credential"].credential_type = Github Personal Access Token
[4].block[3].register = result
[4].block[3].when = github_found
[4].block[4].name = Assert Github PAT credential created
[4].block[4]["ansible.builtin.assert"].that[0] = result.changed
[4].block[4].when = github_found
[4].block[5].name = Add email notification
[4].block[5]["awx.awx.notification_template"].name = {{ email_not }}
[4].block[5]["awx.awx.notification_template"].organization = Default
[4].block[5]["awx.awx.notification_template"].notification_type = email
[4].block[5]["awx.awx.notification_template"].notification_configuration.username = user
[4].block[5]["awx.awx.notification_template"].notification_configuration.password = s3cr3t
[4].block[5]["awx.awx.notification_template"].notification_configuration.sender = tower@example.com
[4].block[5]["awx.awx.notification_template"].notification_configuration.recipients[0] = user1@example.com
[4].block[5]["awx.awx.notification_template"].notification_configuration.host = smtp.example.com
[4].block[5]["awx.awx.notification_template"].notification_configuration.port = 25
[4].block[5]["awx.awx.notification_template"].notification_configuration.use_tls = false
[4].block[5]["awx.awx.notification_template"].notification_configuration.use_ssl = false
[4].block[5]["awx.awx.notification_template"].state = present
[4].block[6].name = Add webhook notification
[4].block[6]["awx.awx.notification_template"].name = {{ webhook_notification }}
[4].block[6]["awx.awx.notification_template"].organization = Default
[4].block[6]["awx.awx.notification_template"].notification_type = webhook
[4].block[6]["awx.awx.notification_template"].notification_configuration.url = http://www.example.com/hook
[4].block[6]["awx.awx.notification_template"].notification_configuration.headers.X-Custom-Header = value123
[4].block[6]["awx.awx.notification_template"].state = present
[4].block[6].register = result
[4].block[7].name = Create Labels for WFJT
[4].block[7]["awx.awx.label"].name = {{ lab1 }}
[4].block[7]["awx.awx.label"].organization = {{ item }}
[4].block[7].loop[0] = Default
[4].block[7].loop[1] = {{ org_name }}
[4].block[8].name = Create a Demo Project
[4].block[8]["awx.awx.project"].name = {{ demo_project_name }}
[4].block[8]["awx.awx.project"].organization = Default
[4].block[8]["awx.awx.project"].state = present
[4].block[8]["awx.awx.project"].scm_type = git
[4].block[8]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].block[8]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].block[8].register = result
[4].block[9].name = Assert demo project created
[4].block[9]["ansible.builtin.assert"].that[0] = result.changed
[4].block[10].name = Create a 2nd Demo Project in another org
[4].block[10]["awx.awx.project"].name = {{ demo_project_name_2 }}
[4].block[10]["awx.awx.project"].organization = {{ org_name }}
[4].block[10]["awx.awx.project"].state = present
[4].block[10]["awx.awx.project"].scm_type = git
[4].block[10]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].block[10]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].block[10].register = result
[4].block[11].name = Assert 2nd demo project created
[4].block[11]["ansible.builtin.assert"].that[0] = result.changed
[4].block[12].name = Create a 3rd Demo Project in another org with inventory source name
[4].block[12]["awx.awx.project"].name = {{ project_inv_source }}
[4].block[12]["awx.awx.project"].organization = {{ org_name }}
[4].block[12]["awx.awx.project"].state = present
[4].block[12]["awx.awx.project"].scm_type = git
[4].block[12]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].block[12]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].block[12].register = result
[4].block[13].name = Assert 3rd demo project created
[4].block[13]["ansible.builtin.assert"].that[0] = result.changed
[4].block[14].name = Add an inventory
[4].block[14]["awx.awx.inventory"].description = Test inventory
[4].block[14]["awx.awx.inventory"].organization = Default
[4].block[14]["awx.awx.inventory"].name = {{ project_inv }}
[4].block[15].name = Create a source inventory
[4].block[15]["awx.awx.inventory_source"].name = {{ project_inv_source }}
[4].block[15]["awx.awx.inventory_source"].description = Source for Test inventory
[4].block[15]["awx.awx.inventory_source"].inventory = {{ project_inv }}
[4].block[15]["awx.awx.inventory_source"].source_project = {{ demo_project_name }}
[4].block[15]["awx.awx.inventory_source"].source_path = /inventories/inventory.ini
[4].block[15]["awx.awx.inventory_source"].overwrite = true
[4].block[15]["awx.awx.inventory_source"].source = scm
[4].block[15].register = project_inv_source_result
[4].block[16].name = Assert inventory source created
[4].block[16]["ansible.builtin.assert"].that[0] = project_inv_source_result.changed
[4].block[17].name = Add a node to demo inventory so we can use a slice count properly
[4].block[17]["awx.awx.host"].name = {{ host1 }}
[4].block[17]["awx.awx.host"].inventory = Demo Inventory
[4].block[17]["awx.awx.host"].variables.ansible_connection = local
[4].block[17].register = results
[4].block[18].name = Assert node added to inventory
[4].block[18]["ansible.builtin.assert"].that[0] = results.changed
[4].block[19].name = Create a Job Template
[4].block[19]["awx.awx.job_template"].name = {{ jt1_name }}
[4].block[19]["awx.awx.job_template"].project = {{ demo_project_name }}
[4].block[19]["awx.awx.job_template"].inventory = Demo Inventory
[4].block[19]["awx.awx.job_template"].ask_inventory_on_launch = true
[4].block[19]["awx.awx.job_template"].ask_credential_on_launch = true
[4].block[19]["awx.awx.job_template"].ask_labels_on_launch = true
[4].block[19]["awx.awx.job_template"].playbook = hello_world.yml
[4].block[19]["awx.awx.job_template"].job_type = run
[4].block[19]["awx.awx.job_template"].state = present
[4].block[19].register = result
[4].block[20].name = Assert job template created
[4].block[20]["ansible.builtin.assert"].that[0] = result.changed
[4].block[21].name = Create a second Job Template
[4].block[21]["awx.awx.job_template"].name = {{ jt2_name }}
[4].block[21]["awx.awx.job_template"].project = {{ demo_project_name }}
[4].block[21]["awx.awx.job_template"].inventory = Demo Inventory
[4].block[21]["awx.awx.job_template"].playbook = hello_world.yml
[4].block[21]["awx.awx.job_template"].job_type = run
[4].block[21]["awx.awx.job_template"].state = present
[4].block[21].register = result
[4].block[22].name = Assert second job template created
[4].block[22]["ansible.builtin.assert"].that[0] = result.changed
[4].block[23].name = Create a second Job Template in new org
[4].block[23]["awx.awx.job_template"].name = {{ jt2_name }}
[4].block[23]["awx.awx.job_template"].project = {{ demo_project_name_2 }}
[4].block[23]["awx.awx.job_template"].inventory = Demo Inventory
[4].block[23]["awx.awx.job_template"].playbook = hello_world.yml
[4].block[23]["awx.awx.job_template"].job_type = run
[4].block[23]["awx.awx.job_template"].state = present
[4].block[23]["awx.awx.job_template"].ask_execution_environment_on_launch = true
[4].block[23]["awx.awx.job_template"].ask_forks_on_launch = true
[4].block[23]["awx.awx.job_template"].ask_instance_groups_on_launch = true
[4].block[23]["awx.awx.job_template"].ask_timeout_on_launch = true
[4].block[23]["awx.awx.job_template"].ask_job_slice_count_on_launch = true
[4].block[23]["awx.awx.job_template"].ask_labels_on_launch = true
[4].block[23].register = jt2_name_result
[4].block[24].name = Assert second job template in new org created
[4].block[24]["ansible.builtin.assert"].that[0] = jt2_name_result.changed
[4].block[25].name = Add a Survey to second Job Template
[4].block[25]["awx.awx.job_template"].name = {{ jt2_name }}
[4].block[25]["awx.awx.job_template"].organization = Default
[4].block[25]["awx.awx.job_template"].project = {{ demo_project_name }}
[4].block[25]["awx.awx.job_template"].inventory = Demo Inventory
[4].block[25]["awx.awx.job_template"].playbook = hello_world.yml
[4].block[25]["awx.awx.job_template"].job_type = run
[4].block[25]["awx.awx.job_template"].state = present
[4].block[25]["awx.awx.job_template"].survey_enabled = true
[4].block[25]["awx.awx.job_template"].survey_spec = {"spec": [{"index": 0, "question_name": "my question?", "default": "mydef", "variable": "myvar", "type": "text", "required": false}], "description": "test", "name": "test"}
[4].block[25]["awx.awx.job_template"].ask_execution_environment_on_launch = true
[4].block[25]["awx.awx.job_template"].ask_forks_on_launch = true
[4].block[25]["awx.awx.job_template"].ask_instance_groups_on_launch = true
[4].block[25]["awx.awx.job_template"].ask_timeout_on_launch = true
[4].block[25]["awx.awx.job_template"].ask_job_slice_count_on_launch = true
[4].block[25]["awx.awx.job_template"].ask_labels_on_launch = true
[4].block[25].register = result
[4].block[26].name = Assert survey added to job template
[4].block[26]["ansible.builtin.assert"].that[0] = result.changed
[4].block[27].name = Create a workflow job template
[4].block[27]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[27]["awx.awx.workflow_job_template"].organization = Default
[4].block[27]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[27]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[27]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[27]["awx.awx.workflow_job_template"].labels[0] = {{ lab1 }}
[4].block[27]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[27]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = true
[4].block[27]["awx.awx.workflow_job_template"].ask_limit_on_launch = true
[4].block[27]["awx.awx.workflow_job_template"].ask_tags_on_launch = true
[4].block[27]["awx.awx.workflow_job_template"].ask_variables_on_launch = true
[4].block[27].register = result
[4].block[28].name = Assert workflow job template created
[4].block[28]["ansible.builtin.assert"].that[0] = result.changed == true
[4].block[29].name = Create a workflow job template with exists
[4].block[29]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[29]["awx.awx.workflow_job_template"].organization = Default
[4].block[29]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[29]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[29]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[29]["awx.awx.workflow_job_template"].labels[0] = {{ lab1 }}
[4].block[29]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[29]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = true
[4].block[29]["awx.awx.workflow_job_template"].ask_limit_on_launch = true
[4].block[29]["awx.awx.workflow_job_template"].ask_tags_on_launch = true
[4].block[29]["awx.awx.workflow_job_template"].ask_variables_on_launch = true
[4].block[29]["awx.awx.workflow_job_template"].state = exists
[4].block[29].register = result
[4].block[30].name = Assert workflow job template with exists did not change
[4].block[30]["ansible.builtin.assert"].that[0] = not result.changed
[4].block[31].name = Delete a workflow job template
[4].block[31]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[31]["awx.awx.workflow_job_template"].organization = Default
[4].block[31]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[31]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[31]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[31]["awx.awx.workflow_job_template"].labels[0] = {{ lab1 }}
[4].block[31]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[31]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = true
[4].block[31]["awx.awx.workflow_job_template"].ask_limit_on_launch = true
[4].block[31]["awx.awx.workflow_job_template"].ask_tags_on_launch = true
[4].block[31]["awx.awx.workflow_job_template"].ask_variables_on_launch = true
[4].block[31]["awx.awx.workflow_job_template"].state = absent
[4].block[31].register = result
[4].block[32].name = Assert workflow job template deleted
[4].block[32]["ansible.builtin.assert"].that[0] = result.changed
[4].block[33].name = Create a workflow job template with exists
[4].block[33]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[33]["awx.awx.workflow_job_template"].organization = Default
[4].block[33]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[33]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[33]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[33]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[33]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = true
[4].block[33]["awx.awx.workflow_job_template"].ask_limit_on_launch = true
[4].block[33]["awx.awx.workflow_job_template"].ask_tags_on_launch = true
[4].block[33]["awx.awx.workflow_job_template"].ask_variables_on_launch = true
[4].block[33]["awx.awx.workflow_job_template"].state = exists
[4].block[33].register = result
[4].block[34].name = Assert workflow job template with exists created
[4].block[34]["ansible.builtin.assert"].that[0] = result.changed
[4].block[35].name = Create a workflow job template with bad label
[4].block[35]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[35]["awx.awx.workflow_job_template"].organization = Default
[4].block[35]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[35]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[35]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[35]["awx.awx.workflow_job_template"].labels[0] = label_bad
[4].block[35]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[35]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = true
[4].block[35]["awx.awx.workflow_job_template"].ask_limit_on_launch = true
[4].block[35]["awx.awx.workflow_job_template"].ask_tags_on_launch = true
[4].block[35]["awx.awx.workflow_job_template"].ask_variables_on_launch = true
[4].block[35].register = results
[4].block[35].ignore_errors = true
[4].block[36].name = Assert creation failed due to bad label
[4].block[36]["ansible.builtin.assert"].that[0] = results.failed
[4].block[37].name = Turn ask_* settings OFF
[4].block[37]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[37]["awx.awx.workflow_job_template"].ask_inventory_on_launch = false
[4].block[37]["awx.awx.workflow_job_template"].ask_scm_branch_on_launch = false
[4].block[37]["awx.awx.workflow_job_template"].ask_limit_on_launch = false
[4].block[37]["awx.awx.workflow_job_template"].ask_tags_on_launch = false
[4].block[37]["awx.awx.workflow_job_template"].ask_variables_on_launch = false
[4].block[37]["awx.awx.workflow_job_template"].state = present
[4].block[38].name = Assert ask settings are off
[4].block[38]["ansible.builtin.assert"].that[0] = result.changed
[4].block[39].name = Create Labels
[4].block[39]["awx.awx.label"].name = {{ item }}
[4].block[39]["awx.awx.label"].organization = Default
[4].block[39].loop[0] = {{ label1 }}
[4].block[39].loop[1] = {{ label2 }}
[4].block[40].name = Create an execution environment
[4].block[40]["awx.awx.execution_environment"].name = {{ ee1 }}
[4].block[40]["awx.awx.execution_environment"].image = junk
[4].block[41].name = Create instance groups
[4].block[41]["awx.awx.instance_group"].name = {{ item }}
[4].block[41].loop[0] = {{ ig1 }}
[4].block[41].loop[1] = {{ ig2 }}
[4].block[42].name = Create leaf node
[4].block[42]["awx.awx.workflow_job_template_node"].identifier = leaf
[4].block[42]["awx.awx.workflow_job_template_node"].unified_job_template = {{ jt2_name }}
[4].block[42]["awx.awx.workflow_job_template_node"].lookup_organization = {{ org_name }}
[4].block[42]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[42]["awx.awx.workflow_job_template_node"].execution_environment = {{ ee1 }}
[4].block[42]["awx.awx.workflow_job_template_node"].forks = 12
[4].block[42]["awx.awx.workflow_job_template_node"].instance_groups[0] = {{ ig1 }}
[4].block[42]["awx.awx.workflow_job_template_node"].instance_groups[1] = {{ ig2 }}
[4].block[42]["awx.awx.workflow_job_template_node"].job_slice_count = 2
[4].block[42]["awx.awx.workflow_job_template_node"].labels[0] = {{ label1 }}
[4].block[42]["awx.awx.workflow_job_template_node"].labels[1] = {{ label2 }}
[4].block[42]["awx.awx.workflow_job_template_node"].timeout = 23
[4].block[42].register = results
[4].block[43].name = Assert leaf node created
[4].block[43]["ansible.builtin.assert"].that[0] = results.changed
[4].block[44].name = Update prompts on leaf node
[4].block[44]["awx.awx.workflow_job_template_node"].identifier = leaf
[4].block[44]["awx.awx.workflow_job_template_node"].unified_job_template = {{ jt2_name }}
[4].block[44]["awx.awx.workflow_job_template_node"].lookup_organization = {{ org_name }}
[4].block[44]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[44]["awx.awx.workflow_job_template_node"].execution_environment = 
[4].block[44]["awx.awx.workflow_job_template_node"].forks = 1
[4].block[44]["awx.awx.workflow_job_template_node"].job_slice_count = 1
[4].block[44]["awx.awx.workflow_job_template_node"].timeout = 10
[4].block[44].register = results
[4].block[45].name = Assert leaf node prompts updated
[4].block[45]["ansible.builtin.assert"].that[0] = results.changed
[4].block[46].name = Remove a node from a workflow that does not exist.
[4].block[46]["awx.awx.workflow_job_template_node"].identifier = root
[4].block[46]["awx.awx.workflow_job_template_node"].unified_job_template = {{ jt1_name }}
[4].block[46]["awx.awx.workflow_job_template_node"].workflow = Does not exist
[4].block[46]["awx.awx.workflow_job_template_node"].state = absent
[4].block[46].register = results
[4].block[47].name = Assert non-existent node was not changed
[4].block[47]["ansible.builtin.assert"].that[0] = not results.changed
[4].block[48].name = Create root node
[4].block[48]["awx.awx.workflow_job_template_node"].identifier = root
[4].block[48]["awx.awx.workflow_job_template_node"].unified_job_template = {{ jt1_name }}
[4].block[48]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[49].name = Fail if no name is set for approval
[4].block[49]["awx.awx.workflow_job_template_node"].identifier = approval_test
[4].block[49]["awx.awx.workflow_job_template_node"].approval_node.description = {{ approval_node_name }}
[4].block[49]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[49].register = no_name_results
[4].block[49].failed_when = false
[4].block[49].ignore_errors = true
[4].block[50].name = Assert no name for approval failed
[4].block[50]["ansible.builtin.assert"].that[0] = no_name_results.msg is search('Approval node name is required to create approval node.')
[4].block[51].name = Fail if absent and no identifier set
[4].block[51]["awx.awx.workflow_job_template_node"].identifier = approval_test
[4].block[51]["awx.awx.workflow_job_template_node"].approval_node.description = {{ approval_node_name }}
[4].block[51]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[51]["awx.awx.workflow_job_template_node"].state = absent
[4].block[51].register = no_identifier_results
[4].block[51].failed_when = false
[4].block[51].ignore_errors = true
[4].block[52].name = Assert no identifier failed
[4].block[52]["ansible.builtin.assert"].that[0] = no_identifier_results is defined
[4].block[52]["ansible.builtin.assert"].that[1] = no_identifier_results is not none
[4].block[53].name = Fail if present and no unified job template set
[4].block[53]["awx.awx.workflow_job_template_node"].identifier = approval_test
[4].block[53]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[53].register = no_unified_results
[4].block[53].failed_when = false
[4].block[53].ignore_errors = true
[4].block[54].name = Assert no unified job template defined
[4].block[54]["ansible.builtin.assert"].that[0] = no_unified_results is defined
[4].block[55].name = Assert module failed gracefully
[4].block[55]["ansible.builtin.assert"].that[0] = no_unified_results is defined
[4].block[56].name = Create approval node
[4].block[56]["awx.awx.workflow_job_template_node"].identifier = approval_test
[4].block[56]["awx.awx.workflow_job_template_node"].approval_node.name = {{ approval_node_name }}
[4].block[56]["awx.awx.workflow_job_template_node"].approval_node.timeout = 900
[4].block[56]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[57].name = Create link for root node
[4].block[57]["awx.awx.workflow_job_template_node"].identifier = root
[4].block[57]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[57]["awx.awx.workflow_job_template_node"].success_nodes[0] = approval_test
[4].block[57]["awx.awx.workflow_job_template_node"].always_nodes[0] = leaf
[4].block[58].name = Delete approval node
[4].block[58]["awx.awx.workflow_job_template_node"].identifier = approval_test
[4].block[58]["awx.awx.workflow_job_template_node"].approval_node.name = {{ approval_node_name }}
[4].block[58]["awx.awx.workflow_job_template_node"].state = absent
[4].block[58]["awx.awx.workflow_job_template_node"].workflow = {{ wfjt_name }}
[4].block[59].name = Add started notifications to workflow job template
[4].block[59]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[59]["awx.awx.workflow_job_template"].notification_templates_started[0] = {{ email_not }}
[4].block[59]["awx.awx.workflow_job_template"].notification_templates_started[1] = {{ webhook_notification }}
[4].block[59].register = result
[4].block[60].name = Assert started notifications added
[4].block[60]["ansible.builtin.assert"].that[0] = result.changed
[4].block[61].name = Re Add started notifications to workflow job template
[4].block[61]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[61]["awx.awx.workflow_job_template"].notification_templates_started[0] = {{ email_not }}
[4].block[61]["awx.awx.workflow_job_template"].notification_templates_started[1] = {{ webhook_notification }}
[4].block[61].register = result
[4].block[62].name = Assert started notifications not re-added
[4].block[62]["ansible.builtin.assert"].that[0] = not result.changed
[4].block[63].name = Add success notifications to workflow job template
[4].block[63]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[63]["awx.awx.workflow_job_template"].notification_templates_success[0] = {{ email_not }}
[4].block[63]["awx.awx.workflow_job_template"].notification_templates_success[1] = {{ webhook_notification }}
[4].block[63].register = result
[4].block[64].name = Assert success notifications added
[4].block[64]["ansible.builtin.assert"].that[0] = result.changed
[4].block[65].name = Copy a workflow job template
[4].block[65]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[65]["awx.awx.workflow_job_template"].copy_from = {{ wfjt_name }}
[4].block[65]["awx.awx.workflow_job_template"].organization = Default
[4].block[65].register = result
[4].block[66].name = Assert workflow job template copied
[4].block[66]["ansible.builtin.assert"].that[0] = result.copied
[4].block[67].name = Fail Remove "on start" webhook notification from copied workflow job template
[4].block[67]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[67]["awx.awx.workflow_job_template"].notification_templates_started[0] = {{ email_not }}123
[4].block[67].register = remove_copied_workflow_node
[4].block[67].failed_when = false
[4].block[67].ignore_errors = true
[4].block[68].name = Assert remove of non-existent notification failed
[4].block[68]["ansible.builtin.assert"].that[0] = not remove_copied_workflow_node.changed
[4].block[68]["ansible.builtin.assert"].that[1] = remove_copied_workflow_node.msg is search('returned 0 items')
[4].block[69].name = Remove "on start" webhook notification from copied workflow job template
[4].block[69]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[69]["awx.awx.workflow_job_template"].notification_templates_started[0] = {{ email_not }}
[4].block[69].register = result
[4].block[70].name = Assert "on start" notification removed
[4].block[70]["ansible.builtin.assert"].that[0] = result.changed
[4].block[71].name = Add Survey to Copied workflow job template
[4].block[71]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[71]["awx.awx.workflow_job_template"].organization = Default
[4].block[71]["awx.awx.workflow_job_template"].ask_inventory_on_launch = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.name = Basic Survey
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.description = Basic Survey
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].question_description = Name
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].min = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].default = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].max = 128
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].required = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].choices = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].new_question = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].variable = basic_name
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].question_name = Basic Name
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[0].type = text
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].question_description = Choosing yes or no.
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].min = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].default = yes
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].max = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].required = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].choices = yes
no
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].new_question = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].variable = option_true_false
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].question_name = Choose yes or no?
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[1].type = multiplechoice
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].question_description = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].min = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].default = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].max = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].required = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].choices = group1
group2
group3
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].new_question = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].variable = target_groups
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].question_name = Select Group:
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[2].type = multiselect
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].question_name = password
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].question_description = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].required = true
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].type = password
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].variable = password
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].min = 0
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].max = 1024
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].default = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].choices = 
[4].block[71]["awx.awx.workflow_job_template"].survey_spec.spec[3].new_question = true
[4].block[71].register = result
[4].block[72].name = Assert survey added to copied workflow
[4].block[72]["ansible.builtin.assert"].that[0] = result.changed
[4].block[73].name = Re add survey to workflow job template expected not changed.
[4].block[73]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[73]["awx.awx.workflow_job_template"].organization = Default
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.name = Basic Survey
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.description = Basic Survey
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].question_description = Name
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].min = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].default = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].max = 128
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].required = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].choices = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].new_question = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].variable = basic_name
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].question_name = Basic Name
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[0].type = text
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].question_description = Choosing yes or no.
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].min = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].default = yes
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].max = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].required = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].choices = yes
no
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].new_question = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].variable = option_true_false
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].question_name = Choose yes or no?
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[1].type = multiplechoice
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].question_description = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].min = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].default = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].max = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].required = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].choices = group1
group2
group3
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].new_question = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].variable = target_groups
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].question_name = Select Group:
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[2].type = multiselect
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].question_name = password
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].question_description = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].required = true
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].type = password
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].variable = password
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].min = 0
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].max = 1024
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].default = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].choices = 
[4].block[73]["awx.awx.workflow_job_template"].survey_spec.spec[3].new_question = true
[4].block[73].register = result
[4].block[74].name = Assert survey not re-added
[4].block[74]["ansible.builtin.assert"].that[0] = not result.changed
[4].block[75].name = Remove "on start" webhook notification from workflow job template
[4].block[75]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[75]["awx.awx.workflow_job_template"].notification_templates_started[0] = {{ email_not }}
[4].block[75].register = result
[4].block[76].name = Assert "on start" webhook notification removed
[4].block[76]["ansible.builtin.assert"].that[0] = result.changed
[4].block[77].name = Delete a workflow job template with an invalid inventory and webook_credential
[4].block[77]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[77]["awx.awx.workflow_job_template"].inventory = Does Not Exist
[4].block[77]["awx.awx.workflow_job_template"].webhook_credential = Does Not Exist
[4].block[77]["awx.awx.workflow_job_template"].state = absent
[4].block[77].register = result
[4].block[78].name = Assert workflow job template with invalid inventory deleted
[4].block[78]["ansible.builtin.assert"].that[0] = result.changed
[4].block[79].name = Check module fails with correct msg
[4].block[79]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[79]["awx.awx.workflow_job_template"].organization = Non_Existing_Organization
[4].block[79].register = result
[4].block[79].failed_when = false
[4].block[79].ignore_errors = true
[4].block[80].name = Assert module failed as expected for non-existent org
[4].block[80]["ansible.builtin.assert"].that[0] = result.msg is search('returned 0 items, expected 1')
[4].block[80]["ansible.builtin.assert"].that[1] = result.msg is search('Non_Existing_Organization')
[4].block[81].name = Create a workflow job template with workflow nodes in template
[4].block[81]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[81]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[81]["awx.awx.workflow_job_template"].extra_vars.foo = bar
[4].block[81]["awx.awx.workflow_job_template"].extra_vars.another-foo.barz = bar2
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[0].identifier = node101
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[0].unified_job_template.id = {{ project_inv_source_result.id }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[0].failure_nodes[0].identifier = node201
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[1].identifier = node102
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.organization.name = {{ org_name }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.name = {{ demo_project_name_2 }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.type = project
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[1].success_nodes[0].identifier = node201
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].identifier = node201
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.organization.name = Default
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.name = {{ jt1_name }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.type = job_template
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].inventory.name = Demo Inventory
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].inventory.organization.name = Default
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].success_nodes[0].identifier = node401
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].failure_nodes[0].identifier = node301
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].credentials[0].name = {{ scm_cred_name }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].credentials[0].organization.name = Default
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].instance_groups[0].name = {{ ig1 }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].labels[0].name = {{ lab1 }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[2].labels[0].organization.name = {{ org_name }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].all_parents_must_converge = false
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].identifier = node301
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].unified_job_template.description = Approval node for example
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].unified_job_template.timeout = 900
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].unified_job_template.type = workflow_approval
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].unified_job_template.name = {{ approval_node_name }}
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[3].success_nodes[0].identifier = node401
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[4].identifier = node401
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[4].unified_job_template.name = Cleanup Activity Stream
[4].block[81]["awx.awx.workflow_job_template"].workflow_nodes[4].unified_job_template.type = system_job_template
[4].block[81].register = result
[4].block[81].failed_when = false
[4].block[82].name = Assert workflow job template with nodes created
[4].block[82]["ansible.builtin.assert"].that[0] = result is not failed
[4].block[82]["ansible.builtin.assert"].that[1] = result is defined
[4].block[83].name = Kick off a workflow and wait for it
[4].block[83]["awx.awx.workflow_launch"].workflow_template = {{ wfjt_name }}
[4].block[83].register = result
[4].block[83].failed_when = false
[4].block[84].name = Assert workflow kicked off and waited
[4].block[84]["ansible.builtin.assert"].that[0] = not result.failed
[4].block[84]["ansible.builtin.assert"].that[1] = 'id' in result['job_info']
[4].block[85].name = Destroy previous workflow nodes for one that fails
[4].block[85]["awx.awx.workflow_job_template"].name = {{ wfjt_name }}
[4].block[85]["awx.awx.workflow_job_template"].destroy_current_nodes = true
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[0].identifier = node101
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[0].unified_job_template.organization.name = Default
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[0].unified_job_template.name = {{ jt1_name }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[0].unified_job_template.type = job_template
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[0].success_nodes[0].identifier = node201
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[1].identifier = node201
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.name = {{ project_inv_source }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.inventory.name = {{ project_inv }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.inventory.organization.name = Default
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[1].unified_job_template.type = inventory_source
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].identifier = Workflow inception
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.name = copy_{{ wfjt_name }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.organization.name = Default
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].unified_job_template.type = workflow_job_template
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].credentials[0].name = {{ scm_cred_name }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].credentials[0].organization.name = Default
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].instance_groups[0].name = {{ ig1 }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].instance_groups[1].name = {{ ig2 }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].labels[0].name = {{ label1 }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].labels[1].name = {{ label2 }}
[4].block[85]["awx.awx.workflow_job_template"].workflow_nodes[2].labels[1].organization.name = {{ org_name }}
[4].block[85].register = result
[4].block[86].name = Delete copied workflow job template
[4].block[86]["awx.awx.workflow_job_template"].name = copy_{{ wfjt_name }}
[4].block[86]["awx.awx.workflow_job_template"].state = absent
[4].block[86].register = result
[4].block[87].name = Assert copied workflow job template deleted
[4].block[87]["ansible.builtin.assert"].that[0] = result.changed
[4].block[88].name = Kick off a workflow and wait for it
[4].block[88]["awx.awx.workflow_launch"].workflow_template = {{ wfjt_name }}
[4].block[88].register = result
[4].block[88].failed_when = false
[4].block[89].name = Assert the workflow failed as expected
[4].block[89]["ansible.builtin.assert"].that[0] = result.status == "failed"
[4].block[89]["ansible.builtin.assert"].fail_msg = Workflow did not fail as expected. Status: {{ result.status }}
[4].block[89]["ansible.builtin.assert"].success_msg = Workflow failed as expected.
[4].block[90].name = Create a workflow job template with a GitLab webhook but a GitHub credential
[4].block[90]["awx.awx.workflow_job_template"].name = {{ webhook_wfjt_name }}
[4].block[90]["awx.awx.workflow_job_template"].organization = Default
[4].block[90]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[90]["awx.awx.workflow_job_template"].webhook_service = {{ 'gitlab' if gitlab_found else omit }}
[4].block[90]["awx.awx.workflow_job_template"].webhook_credential = {{ github_webhook_credential_name if github_found else omit }}
[4].block[90].register = result
[4].block[90].failed_when = false
[4].block[91].name = Assert GitLab webhook with Github cred failed
[4].block[91]["ansible.builtin.assert"].that[0] = result.failed
[4].block[91]["ansible.builtin.assert"].that[1] = result.msg in search('Must match the selected webhook service')
[4].block[91].when = github_found and gitlab_found
[4].block[92].name = Create a workflow job template with a GitHub webhook and a GitHub credential
[4].block[92]["awx.awx.workflow_job_template"].name = {{ webhook_wfjt_name }}
[4].block[92]["awx.awx.workflow_job_template"].organization = Default
[4].block[92]["awx.awx.workflow_job_template"].inventory = Demo Inventory
[4].block[92]["awx.awx.workflow_job_template"].webhook_service = {{ 'github' if github_found else omit }}
[4].block[92]["awx.awx.workflow_job_template"].webhook_credential = {{ github_webhook_credential_name if github_found else omit }}
[4].block[92].register = result
[4].block[93].name = Assert Github webhook with Github cred created
[4].block[93]["ansible.builtin.assert"].that[0] = not result.failed
[4].always[0].name = Cleanup created resources
[4].always[0].block[0].name = Delete the workflow job template
[4].always[0].block[0]["awx.awx.workflow_job_template"].name = {{ item }}
[4].always[0].block[0]["awx.awx.workflow_job_template"].state = absent
[4].always[0].block[0].failed_when = false
[4].always[0].block[0].loop[0] = copy_{{ wfjt_name }}
[4].always[0].block[0].loop[1] = {{ wfjt_name }}
[4].always[0].block[0].loop[2] = {{ webhook_wfjt_name }}
[4].always[0].block[1].name = Delete the Job Template
[4].always[0].block[1]["awx.awx.job_template"].name = {{ jt1_name }}
[4].always[0].block[1]["awx.awx.job_template"].project = {{ demo_project_name }}
[4].always[0].block[1]["awx.awx.job_template"].inventory = Demo Inventory
[4].always[0].block[1]["awx.awx.job_template"].playbook = hello_world.yml
[4].always[0].block[1]["awx.awx.job_template"].job_type = run
[4].always[0].block[1]["awx.awx.job_template"].state = absent
[4].always[0].block[1].failed_when = false
[4].always[0].block[2].name = Delete the second Job Template
[4].always[0].block[2]["awx.awx.job_template"].name = {{ jt2_name }}
[4].always[0].block[2]["awx.awx.job_template"].project = {{ demo_project_name }}
[4].always[0].block[2]["awx.awx.job_template"].organization = Default
[4].always[0].block[2]["awx.awx.job_template"].inventory = Demo Inventory
[4].always[0].block[2]["awx.awx.job_template"].playbook = hello_world.yml
[4].always[0].block[2]["awx.awx.job_template"].job_type = run
[4].always[0].block[2]["awx.awx.job_template"].state = absent
[4].always[0].block[2].failed_when = false
[4].always[0].block[3].name = Delete the second Job Template
[4].always[0].block[3]["awx.awx.job_template"].name = {{ jt2_name }}
[4].always[0].block[3]["awx.awx.job_template"].project = {{ demo_project_name_2 }}
[4].always[0].block[3]["awx.awx.job_template"].organization = {{ org_name }}
[4].always[0].block[3]["awx.awx.job_template"].inventory = Demo Inventory
[4].always[0].block[3]["awx.awx.job_template"].playbook = hello_world.yml
[4].always[0].block[3]["awx.awx.job_template"].job_type = run
[4].always[0].block[3]["awx.awx.job_template"].state = absent
[4].always[0].block[3].failed_when = false
[4].always[0].block[4].name = Delete the inventory source
[4].always[0].block[4]["awx.awx.inventory_source"].name = {{ project_inv_source }}
[4].always[0].block[4]["awx.awx.inventory_source"].inventory = {{ project_inv }}
[4].always[0].block[4]["awx.awx.inventory_source"].source = scm
[4].always[0].block[4]["awx.awx.inventory_source"].state = absent
[4].always[0].block[4].failed_when = false
[4].always[0].block[5].name = Delete the inventory
[4].always[0].block[5]["awx.awx.inventory"].description = Test inventory
[4].always[0].block[5]["awx.awx.inventory"].organization = Default
[4].always[0].block[5]["awx.awx.inventory"].name = {{ project_inv }}
[4].always[0].block[5]["awx.awx.inventory"].state = absent
[4].always[0].block[5].failed_when = false
[4].always[0].block[6].name = Delete the Demo Project
[4].always[0].block[6]["awx.awx.project"].name = {{ demo_project_name }}
[4].always[0].block[6]["awx.awx.project"].organization = Default
[4].always[0].block[6]["awx.awx.project"].scm_type = git
[4].always[0].block[6]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].always[0].block[6]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].always[0].block[6]["awx.awx.project"].state = absent
[4].always[0].block[6].failed_when = false
[4].always[0].block[7].name = Delete the 2nd Demo Project
[4].always[0].block[7]["awx.awx.project"].name = {{ demo_project_name_2 }}
[4].always[0].block[7]["awx.awx.project"].organization = {{ org_name }}
[4].always[0].block[7]["awx.awx.project"].scm_type = git
[4].always[0].block[7]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].always[0].block[7]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].always[0].block[7]["awx.awx.project"].state = absent
[4].always[0].block[7].failed_when = false
[4].always[0].block[8].name = Delete the 3rd Demo Project
[4].always[0].block[8]["awx.awx.project"].name = {{ project_inv_source }}
[4].always[0].block[8]["awx.awx.project"].organization = {{ org_name }}
[4].always[0].block[8]["awx.awx.project"].scm_type = git
[4].always[0].block[8]["awx.awx.project"].scm_url = https://github.com/ansible/ansible-tower-samples.git
[4].always[0].block[8]["awx.awx.project"].scm_credential = {{ scm_cred_name }}
[4].always[0].block[8]["awx.awx.project"].state = absent
[4].always[0].block[8].failed_when = false
[4].always[0].block[9].name = Delete the SCM Credential
[4].always[0].block[9]["awx.awx.credential"].name = {{ scm_cred_name }}
[4].always[0].block[9]["awx.awx.credential"].organization = Default
[4].always[0].block[9]["awx.awx.credential"].credential_type = Source Control
[4].always[0].block[9]["awx.awx.credential"].state = absent
[4].always[0].block[9].failed_when = false
[4].always[0].block[10].name = Delete the GitHub Webhook Credential
[4].always[0].block[10]["awx.awx.credential"].name = {{ github_webhook_credential_name }}
[4].always[0].block[10]["awx.awx.credential"].organization = Default
[4].always[0].block[10]["awx.awx.credential"].credential_type = GitHub Personal Access Token
[4].always[0].block[10]["awx.awx.credential"].state = absent
[4].always[0].block[10].failed_when = false
[4].always[0].block[10].when = github_found
[4].always[0].block[11].name = Delete email notification
[4].always[0].block[11]["awx.awx.notification_template"].name = {{ email_not }}
[4].always[0].block[11]["awx.awx.notification_template"].organization = Default
[4].always[0].block[11]["awx.awx.notification_template"].state = absent
[4].always[0].block[11].failed_when = false
[4].always[0].block[12].name = Delete webhook notification
[4].always[0].block[12]["awx.awx.notification_template"].name = {{ webhook_notification }}
[4].always[0].block[12]["awx.awx.notification_template"].organization = Default
[4].always[0].block[12]["awx.awx.notification_template"].state = absent
[4].always[0].block[12].failed_when = false
[4].always[0].block[13].name = Delete an execution environment
[4].always[0].block[13]["awx.awx.execution_environment"].name = {{ ee1 }}
[4].always[0].block[13]["awx.awx.execution_environment"].image = junk
[4].always[0].block[13]["awx.awx.execution_environment"].state = absent
[4].always[0].block[13].failed_when = false
[4].always[0].block[14].name = Delete instance groups
[4].always[0].block[14]["awx.awx.instance_group"].name = {{ item }}
[4].always[0].block[14]["awx.awx.instance_group"].state = absent
[4].always[0].block[14].loop[0] = {{ ig1 }}
[4].always[0].block[14].loop[1] = {{ ig2 }}
[4].always[0].block[14].failed_when = false
[4].always[0].block[15].name = Remove the organization
[4].always[0].block[15]["awx.awx.organization"].name = {{ org_name }}
[4].always[0].block[15]["awx.awx.organization"].state = absent
[4].always[0].block[15].failed_when = false
[4].always[0].block[16].name = Remove node
[4].always[0].block[16]["awx.awx.host"].name = {{ host1 }}
[4].always[0].block[16]["awx.awx.host"].inventory = Demo Inventory
[4].always[0].block[16]["awx.awx.host"].state = absent
[4].always[0].block[16].failed_when = false
