~d0.name = Stop snmpd before admin account initialization
~d1.ansible.builtin.service = 
~d2.name = 'snmpd'
~d2.state = 'stopped'
~d0.name = Prepare admin account
~d1.ansible.builtin.lineinfile = 
~d2.dest = '/var/lib/snmp/snmpd.conf'
~d2.regexp = '^createUser {{ snmpd_fact_account_admin_username }}'
~d2.line = 'createUser {{ snmpd_fact_account_admin_username }} SHA "{{ snmpd_fact_account_admin_password }}" AES'
~d2.state = 'present'
~d2.mode = '0600'
~d1.no_log = '{{ debops__no_log | d(True) }}'
~d0.name = Start snmpd to initialize admin account
~d1.ansible.builtin.service = 
~d2.name = 'snmpd'
~d2.state = 'started'
~d0.name = Create read-only agent account
~d1.ansible.builtin.command = snmpusm -u {{ snmpd_fact_account_admin_username }} -l authPriv -a SHA -x AES
~d1.changed_when = False
~d1.no_log = '{{ debops__no_log | d(True) }}'
~d0.name = Change agent account password
~d1.ansible.builtin.command = snmpusm -u {{ snmpd_fact_account_admin_username }} -l authPriv -a SHA -x AES
~d1.changed_when = False
~d1.no_log = '{{ debops__no_log | d(True) }}'
~d0.name = Create read-only local account
~d1.ansible.builtin.command = snmpusm -u {{ snmpd_fact_account_admin_username }} -l authPriv -a SHA -x AES
~d1.changed_when = False
~d1.no_log = '{{ debops__no_log | d(True) }}'
~d0.name = Change local account password
~d1.ansible.builtin.command = snmpusm -u {{ snmpd_fact_account_admin_username }} -l authPriv -a SHA -x AES
~d1.changed_when = False
~d1.no_log = '{{ debops__no_log | d(True) }}'
~d0.name = Remove admin account from snmpd.conf
~d1.ansible.builtin.lineinfile = 
~d2.dest = '/etc/snmp/snmpd.conf'
~d2.regexp = '^rwuser\s+{{ snmpd_fact_account_admin_username }}\s+priv'
~d2.state = 'absent'
~d1.no_log = '{{ debops__no_log | d(True) }}'
