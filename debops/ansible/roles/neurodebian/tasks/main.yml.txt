[0].name = Import DebOps global handlers
[0]["ansible.builtin.import_role"].name = global_handlers
[1].name = Configure NeuroDebian APT repository
[1]["ansible.builtin.template"].src = etc/apt/sources.list.d/neurodebian.sources.list.j2
[1]["ansible.builtin.template"].dest = /etc/apt/sources.list.d/neurodebian.sources.list
[1]["ansible.builtin.template"].mode = 0644
[1].register = neurodebian__register_apt_repository
[1].when = (neurodebian__deploy_state == "present" and neurodebian__upstream | bool)
[2].name = Ensure the NeuroDebian APT repository is disabled
[2]["ansible.builtin.file"].path = /etc/apt/sources.list.d/neurodebian.sources.list
[2]["ansible.builtin.file"].state = absent
[2].register = neurodebian__register_apt_repository_absent
[2].when = (neurodebian__deploy_state == "absent" and neurodebian__upstream | bool)
[3].name = Configure NeuroDebian support in debconf
[3]["ansible.builtin.debconf"].name = neurodebian
[3]["ansible.builtin.debconf"].question = neurodebian/enable
[3]["ansible.builtin.debconf"].vtype = boolean
[3]["ansible.builtin.debconf"].value = {{ "true" if (neurodebian__deploy_state == "present") else "false" }}
[3].when = not neurodebian__upstream | bool
[4].name = Install packages required for NeuroDebian support
[4]["ansible.builtin.package"].name = {{ q("flattened", neurodebian__support_packages) }}
[4]["ansible.builtin.package"].state = present
[4].register = neurodebian__register_support_packages
[4].until = neurodebian__register_support_packages is succeeded
[4].when = (neurodebian__deploy_state == "present" and not neurodebian__upstream | bool)
[5].name = Update APT repository cache
[5]["ansible.builtin.apt"].update_cache = True
[5].register = neurodebian__register_apt_update
[5].until = neurodebian__register_apt_update is succeeded
[5].when = neurodebian__register_apt_repository is changed or neurodebian__register_apt_repository_absent is changed or neurodebian__register_support_packages is changed
[6].name = Ensure specified packages are in their desired state
[6]["ansible.builtin.package"].name = {{ q("flattened", (neurodebian__packages
                              + neurodebian__group_packages
                              + neurodebian__host_packages
                              + neurodebian__dependent_packages)) }}
[6]["ansible.builtin.package"].state = {{ "present" if (neurodebian__deploy_state == "present") else "absent" }}
[6].register = neurodebian__register_packages
[6].until = neurodebian__register_packages is succeeded
[6].tags[0] = role::neurodebian:package
[7].name = Make sure that Ansible local facts directory exists
[7]["ansible.builtin.file"].path = /etc/ansible/facts.d
[7]["ansible.builtin.file"].state = directory
[7]["ansible.builtin.file"].mode = 0755
[8].name = Save NeuroDebian local facts
[8]["ansible.builtin.template"].src = etc/ansible/facts.d/neurodebian.fact.j2
[8]["ansible.builtin.template"].dest = /etc/ansible/facts.d/neurodebian.fact
[8]["ansible.builtin.template"].mode = 0755
[8].notify[0] = Refresh host facts
[8].tags[0] = meta::facts
[9].name = Update Ansible facts if they were modified
[9]["ansible.builtin.meta"] = flush_handlers
