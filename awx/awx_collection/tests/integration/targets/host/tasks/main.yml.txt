[0].name = Generate a test ID
[0].set_fact.test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate names
[1].set_fact.host_name = AWX-Collection-tests-host-host-{{ test_id }}
[1].set_fact.inv_name = AWX-Collection-tests-host-inv-{{ test_id }}
[2].name = Create an Inventory
[2].inventory.name = {{ inv_name }}
[2].inventory.organization = Default
[2].inventory.state = present
[2].register = result
[3].name = Create a Host
[3].host.name = {{ host_name }}
[3].host.inventory = {{ result.id }}
[3].host.state = present
[3].host.variables.foo = bar
[3].register = result
[4].assert.that[0] = result is changed
[5].name = Create a Host with exists
[5].host.name = {{ host_name }}
[5].host.inventory = {{ inv_name }}
[5].host.state = exists
[5].host.variables.foo = bar
[5].register = result
[6].assert.that[0] = result is not changed
[7].name = Modify the host as a no-op
[7].host.name = {{ host_name }}
[7].host.inventory = {{ inv_name }}
[7].register = result
[8].assert.that[0] = result is not changed
[9].name = Delete a Host
[9].host.name = {{ host_name }}
[9].host.inventory = {{ inv_name }}
[9].host.state = absent
[9].host.variables.foo = bar
[9].register = result
[10].assert.that[0] = result is changed
[11].name = Create a Host with exists
[11].host.name = {{ host_name }}
[11].host.inventory = {{ inv_name }}
[11].host.state = exists
[11].host.variables.foo = bar
[11].register = result
[12].assert.that[0] = result is changed
[13].name = Use lookup to check that host was enabled
[13].set_fact.host_enabled_test = {{ lookup('awx.awx.controller_api', 'hosts/' + result.id | string + '/').enabled }}
[14].name = Newly created host should have API default value for enabled
[14].assert.that[0] = host_enabled_test is true
[15].name = Delete a Host
[15].host.name = {{ result.id }}
[15].host.inventory = {{ inv_name }}
[15].host.state = absent
[15].register = result
[16].assert.that[0] = result is changed
[17].name = Check module fails with correct msg
[17].host.name = test-host
[17].host.description = Host Description
[17].host.inventory = test-non-existing-inventory
[17].host.state = present
[17].register = result
[17].ignore_errors = yes
[18].assert.that[0] = result is failed
[18].assert.that[1] = 'test-non-existing-inventory' in result.msg
[18].assert.that[2] = result.total_results == 0
