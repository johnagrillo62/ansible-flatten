[0].name = Manage dependencies
[0].block[0].name = Include virtualenv setup tasks
[0].block[0].import_tasks = virtualenv.yml
[0].block[1].name = Install Galaxy base dependencies
[0].block[1].pip.requirements = {{ galaxy_requirements_file }}
[0].block[1].pip.extra_args = --index-url https://wheels.galaxyproject.org/simple/ --extra-index-url https://pypi.python.org/simple {{ pip_extra_args | default('') }}
[0].block[1].pip.virtualenv = {{ galaxy_venv_dir }}
[0].block[1].pip.virtualenv_command = {{ galaxy_virtualenv_command | default(pip_virtualenv_command | default(omit)) }}
[0].block[1].environment.PYTHONPATH = null
[0].block[1].environment.VIRTUAL_ENV = {{ galaxy_venv_dir }}
[0].block[2].name = Collect Galaxy conditional dependency requirement strings
[0].block[2].command = {{ galaxy_venv_dir }}/bin/python -c "import galaxy.dependencies; print('\n'.join(galaxy.dependencies.optional('{{ galaxy_config_file }}')))"
[0].block[2].environment.PYTHONPATH = {{ galaxy_server_dir }}/lib
[0].block[2].register = conditional_dependencies
[0].block[2].changed_when = no
[0].block[3].name = Install Galaxy conditional dependencies
[0].block[3].pip.name = {{ conditional_dependencies.stdout_lines }}
[0].block[3].pip.extra_args = --index-url https://wheels.galaxyproject.org/simple/ --extra-index-url https://pypi.python.org/simple {{ pip_extra_args | default('') }}
[0].block[3].pip.virtualenv = {{ galaxy_venv_dir }}
[0].block[3].pip.virtualenv_command = {{ galaxy_virtualenv_command | default(pip_virtualenv_command | default(omit)) }}
[0].block[3].environment.PYTHONPATH = null
[0].block[3].environment.VIRTUAL_ENV = {{ galaxy_venv_dir }}
[0].block[3].when = (not ansible_check_mode) and conditional_dependencies.stdout_lines | length > 0
[0].block[4].name = Install additional packages into galaxy's virtual environment
[0].block[4].pip.name = {{ galaxy_additional_venv_packages }}
[0].block[4].pip.virtualenv = {{ galaxy_venv_dir }}
[0].block[4].pip.virtualenv_command = {{ galaxy_virtualenv_command | default(pip_virtualenv_command | default(omit)) }}
[0].block[4].environment.PYTHONPATH = null
[0].block[4].environment.VIRTUAL_ENV = {{ galaxy_venv_dir }}
[0].block[4].when = galaxy_additional_venv_packages | length > 0
[0].remote_user = {{ galaxy_remote_users.privsep | default(__galaxy_remote_user) }}
[0].become = {{ true if galaxy_become_users.privsep is defined else __galaxy_become }}
[0].become_user = {{ galaxy_become_users.privsep | default(__galaxy_become_user) }}
