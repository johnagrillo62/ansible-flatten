nsswitch__enabled = True
nsswitch__default_services[0] = compat
nsswitch__default_services[1] = files
nsswitch__default_services[2] = dns
nsswitch__default_services[3] = db
nsswitch__default_services[4] = nis
nsswitch__combined_services = {{ lookup("flattened", (nsswitch__default_services
                                 + nsswitch__services + nsswitch__group_services
                                 + nsswitch__host_services + nsswitch__dependent_services)
                                 | difference(nsswitch__remove_services)).split(",") }}

nsswitch__default_database_map.passwd[0] = compat
nsswitch__default_database_map.passwd[1] = mymachines
nsswitch__default_database_map.passwd[2] = systemd
nsswitch__default_database_map.passwd[3] = sss
nsswitch__default_database_map.passwd[4] = ldap
nsswitch__default_database_map.passwd[5] = winbind
nsswitch__default_database_map.group[0] = compat
nsswitch__default_database_map.group[1] = mymachines
nsswitch__default_database_map.group[2] = systemd
nsswitch__default_database_map.group[3] = sss
nsswitch__default_database_map.group[4] = ldap
nsswitch__default_database_map.group[5] = winbind
nsswitch__default_database_map.shadow[0] = compat
nsswitch__default_database_map.shadow[1] = sss
nsswitch__default_database_map.gshadow[0] = files
nsswitch__default_database_map.hosts[0] = files
nsswitch__default_database_map.hosts[1] = mymachines
nsswitch__default_database_map.hosts[2][0] = mdns_minimal
nsswitch__default_database_map.hosts[2][1] = [NOTFOUND=return]
nsswitch__default_database_map.hosts[3].replace = mdns4_minimal
nsswitch__default_database_map.hosts[3].service = {{ "mdns_minimal" if (ansible_local | d() and ansible_local.avahi | d() and
                                      ansible_local.avahi.ipv6 | bool) else "mdns4_minimal" }} 
nsswitch__default_database_map.hosts[3].action = [NOTFOUND=return]
nsswitch__default_database_map.hosts[4][0] = resolve
nsswitch__default_database_map.hosts[4][1] = [!UNAVAIL=return]
nsswitch__default_database_map.hosts[5] = dns
nsswitch__default_database_map.hosts[6] = libvirt
nsswitch__default_database_map.hosts[7] = libvirt_guest
nsswitch__default_database_map.hosts[8] = wins
nsswitch__default_database_map.hosts[9] = myhostname
nsswitch__default_database_map.networks[0] = files
nsswitch__default_database_map.protocols[0] = db
nsswitch__default_database_map.protocols[1] = files
nsswitch__default_database_map.services[0] = db
nsswitch__default_database_map.services[1] = files
nsswitch__default_database_map.services[2] = sss
nsswitch__default_database_map.services[3] = ldap
nsswitch__default_database_map.ethers[0] = db
nsswitch__default_database_map.ethers[1] = files
nsswitch__default_database_map.rpc[0] = db
nsswitch__default_database_map.rpc[1] = files
nsswitch__default_database_map.netgroup[0] = nis
nsswitch__default_database_map.netgroup[1] = sss
nsswitch__default_database_map.netgroup[2] = ldap
nsswitch__default_database_map.sudoers[0].service = files
nsswitch__default_database_map.sudoers[0].require = False
nsswitch__default_database_map.sudoers[1].service = sss
nsswitch__default_database_map.sudoers[1].require = False
nsswitch__default_database_map.sudoers[2].service = ldap
nsswitch__default_database_map.sudoers[2].require = False
nsswitch__default_database_map.automount[0].service = files
nsswitch__default_database_map.automount[0].require = False
nsswitch__default_database_map.automount[1].service = sss
nsswitch__default_database_map.automount[1].require = False
nsswitch__default_database_map.automount[2].service = ldap
nsswitch__default_database_map.automount[2].require = False
nsswitch__combined_database_map = {{ nsswitch__default_database_map
                                     | combine(nsswitch__database_map)
                                     | combine(nsswitch__group_database_map)
                                     | combine(nsswitch__host_database_map) }}

nsswitch__database_groups[0][0] = passwd
nsswitch__database_groups[0][1] = group
nsswitch__database_groups[0][2] = shadow
nsswitch__database_groups[0][3] = gshadow
nsswitch__database_groups[0][4] = initgroups
nsswitch__database_groups[1][0] = hosts
nsswitch__database_groups[1][1] = networks
nsswitch__database_groups[2][0] = protocols
nsswitch__database_groups[2][1] = services
nsswitch__database_groups[2][2] = ethers
nsswitch__database_groups[2][3] = rpc
nsswitch__database_groups[3][0] = netgroup
nsswitch__database_groups[4][0] = aliases
nsswitch__database_groups[4][1] = sudoers
nsswitch__database_groups[4][2] = automount
