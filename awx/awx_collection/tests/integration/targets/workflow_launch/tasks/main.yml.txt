~d0.name = Generate a random string for test
~d1.ansible.builtin.set_fact = 
~d2.test_id = "{{ lookup('password', '/dev/null chars=ascii_letters length=16') }}"
~d1.when = test_id is not defined
~d0.name = Generate names
~d1.ansible.builtin.set_fact = 
~d2.wfjt_name1 = "AWX-Collection-tests-workflow_launch--wfjt1-{{ test_id }}"
~d2.wfjt_name2 = "AWX-Collection-tests-workflow_launch--wfjt1-{{ test_id }}-2"
~d2.approval_node_name = "AWX-Collection-tests-workflow_launch_approval_node-{{ test_id }}"
~d0.name = Create workflows
~d1.block = 
~d2.name = Create our workflow
~d3.workflow_job_template = 
~d4.name = "{{ wfjt_name1 }}"
~d4.state = present
~d2.name = Add a node
~d3.workflow_job_template_node = 
~d4.workflow_job_template = "{{ wfjt_name1 }}"
~d4.unified_job_template = "Demo Job Template"
~d4.identifier = leaf
~d3.register = new_node
~d2.name = Connect to controller server but request an invalid workflow
~d3.workflow_launch = 
~d4.workflow_template = "Does Not Exist"
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert that workflow launch failed with expected error
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Run the workflow without waiting (this should just give us back a job ID)
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d4.wait = false
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert result not failed
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Kick off a workflow and wait for it, but only for a second
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d4.timeout = 1
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert result failed
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Kick off a workflow and wait for it
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert result did not fail
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Kick off a workflow with extra_vars but not enabled
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d4.extra_vars = 
~d5.var1 = My First Variable
~d5.var2 = My Second Variable
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert result failed
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Prompt the workflow's with survey
~d3.workflow_job_template = 
~d4.name = "{{ wfjt_name1 }}"
~d4.state = present
~d4.survey_enabled = true
~d4.ask_variables_on_launch = false
~d4.survey = 
~d5.name = ''
~d5.description = ''
~d5.spec = 
~d6.question_name = Basic Name
~d7.question_description = Name
~d7.required = true
~d7.type = text
~d7.variable = basic_name
~d7.min = 0
~d7.max = 1024
~d7.default = ''
~d7.choices = ''
~d7.new_question = true
~d6.question_name = Choose yes or no?
~d7.question_description = Choosing yes or no.
~d7.required = false
~d7.type = multiplechoice
~d7.variable = option_true_false
~d7.min = 
~d7.max = 
~d7.default = 'yes'
~d7.choices = |-
~d7.new_question = true
~d2.name = Kick off a workflow with survey
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d4.extra_vars = 
~d5.basic_name = My First Variable
~d5.option_true_false = 'no'
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert result did not fail
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Prompt the workflow's extra_vars on launch
~d3.workflow_job_template = 
~d4.name = "{{ wfjt_name1 }}"
~d4.state = present
~d4.ask_variables_on_launch = true
~d2.name = Kick off a workflow with extra_vars
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name1 }}"
~d4.extra_vars = 
~d5.basic_name = My First Variable
~d5.var1 = My First Variable
~d5.var2 = My Second Variable
~d3.ignore_errors = true
~d3.register = result
~d2.name = Assert did not fail
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Test waiting for an approval node that doesn't exit on the last workflow for failure.
~d3.workflow_approval = 
~d4.workflow_job_id = "{{ result.id }}"
~d4.name = Test workflow approval
~d4.interval = 1
~d4.timeout = 2
~d4.action = deny
~d3.register = result
~d3.ignore_errors = true
~d2.name = Assert result failed
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Create new Workflow
~d3.workflow_job_template = 
~d4.name = "{{ wfjt_name2 }}"
~d4.state = present
~d2.name = Add a job node
~d3.workflow_job_template_node = 
~d4.workflow_job_template = "{{ wfjt_name2 }}"
~d4.unified_job_template = "Demo Job Template"
~d4.identifier = leaf
~d2.name = Create approval node
~d3.workflow_job_template_node = 
~d4.identifier = approval_test
~d4.approval_node = 
~d5.name = "{{ approval_node_name }}"
~d5.timeout = 900
~d4.workflow = "{{ wfjt_name2 }}"
~d2.name = Create link for approval node
~d3.workflow_job_template_node = 
~d4.identifier = approval_test
~d4.workflow = "{{ wfjt_name2 }}"
~d4.always_nodes = 
~d2.name = Run the workflow without waiting This should pause waiting for approval
~d3.workflow_launch = 
~d4.workflow_template = "{{ wfjt_name2 }}"
~d4.wait = false
~d3.ignore_errors = true
~d3.register = wfjt_info
~d2.name = Wait for Job node wait to fail as it is waiting on approval
~d3.awx.awx.workflow_node_wait = 
~d4.workflow_job_id = "{{ wfjt_info.id }}"
~d4.name = Demo Job Template
~d4.interval = 1
~d4.timeout = 5
~d3.register = result
~d3.ignore_errors = true
~d2.name = Assert result didn't fail
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Wait for approval node to activate and approve
~d3.awx.awx.workflow_approval = 
~d4.workflow_job_id = "{{ wfjt_info.id }}"
~d4.name = "{{ approval_node_name }}"
~d4.interval = 1
~d4.timeout = 10
~d4.action = deny
~d3.register = result
~d2.name = Assert did not fail
~d3.ansible.builtin.assert = 
~d4.that = 
~d2.name = Wait for workflow job to finish max 120s
~d3.job_wait = 
~d4.job_id = "{{ wfjt_info.id }}"
~d4.timeout = 120
~d4.job_type = "workflow_jobs"
~d1.always = 
~d2.name = Clean up test workflow
~d3.workflow_job_template = 
~d4.name = "{{ item }}"
~d4.state = absent
~d3.with_items = 
