[0].name = Generate a random string for test
[0].set_fact.test_id = {{ lookup('password', '/dev/null chars=ascii_letters length=16') }}
[0].when = test_id is not defined
[1].name = Generate a unique name
[1].set_fact.bulk_inv_name = AWX-Collection-tests-bulk_host_create-{{ test_id }}
[2].name = Get our collection package
[2].controller_meta = null
[2].register = controller_meta
[3].name = Generate the name of our plugin
[3].set_fact.plugin_name = {{ controller_meta.prefix }}.controller_api
[4].name = Create an inventory
[4].inventory.name = {{ bulk_inv_name }}
[4].inventory.organization = Default
[4].inventory.state = present
[4].register = inventory_result
[5].name = Bulk Host Create
[5].bulk_host_create.hosts[0].name = 123.456.789.123
[5].bulk_host_create.hosts[0].description = myhost1
[5].bulk_host_create.hosts[0].variables.food = carrot
[5].bulk_host_create.hosts[0].variables.color = orange
[5].bulk_host_create.hosts[1].name = example.dns.gg
[5].bulk_host_create.hosts[1].description = myhost2
[5].bulk_host_create.hosts[1].enabled = false
[5].bulk_host_create.inventory = {{ bulk_inv_name }}
[5].register = result
[6].assert.that[0] = result is not failed
[7].name = Get our collection package
[7].controller_meta = null
[7].register = controller_meta
[8].name = Generate the name of our plugin
[8].set_fact.plugin_name = {{ controller_meta.prefix }}.controller_api
[9].name = Setting the inventory hosts endpoint
[9].set_fact.endpoint = inventories/{{ inventory_result.id }}/hosts/
[10].name = Get hosts information from inventory
[10].set_fact.hosts_created = {{ query(plugin_name, endpoint, return_objects=True) }}
[11].name = Extract host IDs from hosts information
[11].set_fact.host_id_list = {{ host_id_list + [item.id] }}
[11].loop = {{ hosts_created }}
[12].name = Bulk Host Delete
[12].bulk_host_delete.hosts = {{ host_id_list }}
[12].register = result
[13].assert.that[0] = result is not failed
[14].name = Delete inventory
[14].inventory.name = {{ bulk_inv_name }}
[14].inventory.organization = Default
[14].inventory.state = absent
