[0].name = Install required packages for phpipam-scripts
[0]["ansible.builtin.package"].name = python-mysqldb
[0]["ansible.builtin.package"].state = present
[0].register = phpipam__register_packages
[0].until = phpipam__register_packages is succeeded
[1].name = Clone phpipam-scripts
[1]["ansible.builtin.git"].repo = {{ phpipam__scripts_git_repo }}
[1]["ansible.builtin.git"].dest = {{ phpipam__scripts_git_dest }}
[1]["ansible.builtin.git"].version = {{ phpipam__scripts_git_version }}
[1]["ansible.builtin.git"].update = True
[1].register = phpipam__register_scripts_src
[2].name = Install phpipam-scripts
[2]["ansible.builtin.command"] = make install
[2].args.chdir = {{ phpipam__scripts_git_dest }}
[2].register = phpipam__register_make_install
[2].changed_when = phpipam__register_make_install.changed | bool
[2].when = phpipam__register_scripts_src is defined and phpipam__register_scripts_src is changed
[3].name = Configure phpipam-scripts
[3]["ansible.builtin.template"].src = etc/dhcp/phpipam.conf.j2
[3]["ansible.builtin.template"].dest = /etc/dhcp/phpipam.conf
[3]["ansible.builtin.template"].owner = root
[3]["ansible.builtin.template"].group = root
[3]["ansible.builtin.template"].mode = 0600
[4].name = Configure phpipam-scripts-wrapper
[4]["ansible.builtin.template"].src = usr/local/sbin/phpipam-hosts-wrapper.j2
[4]["ansible.builtin.template"].dest = /usr/local/sbin/phpipam-hosts-wrapper
[4]["ansible.builtin.template"].owner = root
[4]["ansible.builtin.template"].group = root
[4]["ansible.builtin.template"].mode = 0755
[4].register = phpipam__register_hosts_wrapper
[5].name = Create wrapper script entry in cron
[5]["ansible.builtin.cron"].name = Regenerate DHCP hosts files
[5]["ansible.builtin.cron"].cron_file = phpipam-scripts
[5]["ansible.builtin.cron"].minute = {{ phpipam__scripts_cron_period }}
[5]["ansible.builtin.cron"].job = /usr/local/sbin/phpipam-hosts-wrapper
[5]["ansible.builtin.cron"].user = root
[5]["ansible.builtin.cron"].state = present
