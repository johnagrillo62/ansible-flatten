~d0.name = Generate a test ID
~d1.set_fact = 
~d2.test_id = "{{ lookup('password', '/dev/null chars=ascii_letters length=16') }}"
~d1.when = test_id is not defined
~d0.name = Generate names
~d1.set_fact = 
~d2.host_name = "AWX-Collection-tests-host-host-{{ test_id }}"
~d2.inv_name = "AWX-Collection-tests-host-inv-{{ test_id }}"
~d0.name = Create an Inventory
~d1.inventory = 
~d2.name = "{{ inv_name }}"
~d2.organization = Default
~d2.state = present
~d1.register = result
~d0.name = Create a Host
~d1.host = 
~d2.name = "{{ host_name }}"
~d2.inventory = "{{ result.id }}"
~d2.state = present
~d2.variables = 
~d3.foo = bar
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Create a Host with exists
~d1.host = 
~d2.name = "{{ host_name }}"
~d2.inventory = "{{ inv_name }}"
~d2.state = exists
~d2.variables = 
~d3.foo = bar
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Modify the host as a no-op
~d1.host = 
~d2.name = "{{ host_name }}"
~d2.inventory = "{{ inv_name }}"
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Delete a Host
~d1.host = 
~d2.name = "{{ host_name }}"
~d2.inventory = "{{ inv_name }}"
~d2.state = absent
~d2.variables = 
~d3.foo = bar
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Create a Host with exists
~d1.host = 
~d2.name = "{{ host_name }}"
~d2.inventory = "{{ inv_name }}"
~d2.state = exists
~d2.variables = 
~d3.foo = bar
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Use lookup to check that host was enabled
~d1.set_fact = 
~d2.host_enabled_test = "{{ lookup('awx.awx.controller_api', 'hosts/' + result.id | string + '/').enabled }}"
~d0.name = Newly created host should have API default value for enabled
~d1.assert = 
~d2.that = 
~d0.name = Delete a Host
~d1.host = 
~d2.name = "{{ result.id }}"
~d2.inventory = "{{ inv_name }}"
~d2.state = absent
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Check module fails with correct msg
~d1.host = 
~d2.name = test-host
~d2.description = Host Description
~d2.inventory = test-non-existing-inventory
~d2.state = present
~d1.register = result
~d1.ignore_errors = yes
~d0.assert = 
~d2.that = 
