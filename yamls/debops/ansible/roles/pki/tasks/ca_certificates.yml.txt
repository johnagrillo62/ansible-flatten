[0].name = Set default trust policy for new certificates
[0]["ansible.builtin.debconf"].name = ca-certificates
[0]["ansible.builtin.debconf"].question = ca-certificates/trust_new_crts
[0]["ansible.builtin.debconf"].vtype = select
[0]["ansible.builtin.debconf"].value = {{ "yes" if (pki_system_ca_certificates_trust_new | bool) else "no" }}
[1].name = Get list of known certificates
[1]["ansible.builtin.shell"] = set -o nounset -o pipefail -o errexit && grep -E -e '^[^#].*$' /etc/ca-certificates.conf | sed -e 's/^!//' || true
[1].args.executable = bash
[1].register = pki_register_ca_certificates_known
[1].changed_when = False
[1].check_mode = False
[2].name = Get list of untrusted certificates
[2]["ansible.builtin.shell"] = set -o nounset -o pipefail -o errexit && grep -E -e '^!+' /etc/ca-certificates.conf | sed -e 's/^!//' || true
[2].args.executable = bash
[2].register = pki_register_ca_certificates_untrusted
[2].changed_when = False
[2].check_mode = False
[3].name = Get list of trusted certificates
[3]["ansible.builtin.shell"] = set -o nounset -o pipefail -o errexit && grep -E -e '^[^#!].*$' /etc/ca-certificates.conf | sed -e 's/^!//' || true
[3].args.executable = bash
[3].register = pki_register_ca_certificates_trusted
[3].changed_when = False
[3].check_mode = False
[4].name = Get list of blacklisted certificates
[4]["ansible.builtin.shell"] = set -o nounset -o pipefail -o errexit && grep -E -e '{{ pki_system_ca_certificates_blacklist | join("' -e '") }}' /etc/ca-certificates.conf | sed -e 's/^!//' || true
[4].args.executable = bash
[4].register = pki_register_ca_certificates_blacklist
[4].changed_when = False
[4].check_mode = False
[4].when = pki_system_ca_certificates_blacklist is defined and pki_system_ca_certificates_blacklist
[5].name = Get list of whitelisted certificates
[5]["ansible.builtin.shell"] = set -o nounset -o pipefail -o errexit && grep -E -e '{{ pki_system_ca_certificates_whitelist | join("' -e '") }}' /etc/ca-certificates.conf | sed -e 's/^!//' || true
[5].args.executable = bash
[5].register = pki_register_ca_certificates_whitelist
[5].changed_when = False
[5].check_mode = False
[5].when = pki_system_ca_certificates_whitelist is defined and pki_system_ca_certificates_whitelist
[6].name = Configure system CA certificates
[6]["ansible.builtin.template"].src = etc/ca-certificates.conf.j2
[6]["ansible.builtin.template"].dest = /etc/ca-certificates.conf
[6]["ansible.builtin.template"].owner = root
[6]["ansible.builtin.template"].group = root
[6]["ansible.builtin.template"].mode = 0644
[6].notify[0] = Reconfigure ca-certificates
