[0].name = Check if password history database exists
[0]["ansible.builtin.stat"].path = /etc/security/opasswd
[0].register = auth_register_opasswd
[1].name = Configure password history database
[1]["ansible.builtin.file"].path = /etc/security/opasswd
[1]["ansible.builtin.file"].state = touch
[1]["ansible.builtin.file"].owner = root
[1]["ansible.builtin.file"].group = root
[1]["ansible.builtin.file"].mode = 0600
[1].when = auth_register_opasswd is defined and not auth_register_opasswd.stat.exists
[2].name = Configure pam_pwhistory
[2]["ansible.builtin.template"].src = usr/share/pam-configs/pwhistory.j2
[2]["ansible.builtin.template"].dest = /usr/share/pam-configs/pwhistory
[2]["ansible.builtin.template"].owner = root
[2]["ansible.builtin.template"].group = root
[2]["ansible.builtin.template"].mode = 0644
[2].notify[0] = Update PAM common configuration
