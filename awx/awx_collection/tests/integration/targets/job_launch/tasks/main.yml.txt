~d0.name = Generate a test ID
~d1.set_fact = 
~d2.test_id = "{{ lookup('password', '/dev/null chars=ascii_letters length=16') }}"
~d1.when = test_id is not defined
~d0.name = Generate names
~d1.set_fact = 
~d2.jt_name1 = "AWX-Collection-tests-job_launch-jt1-{{ test_id }}"
~d2.jt_name2 = "AWX-Collection-tests-job_launch-jt2-{{ test_id }}"
~d2.proj_name = "AWX-Collection-tests-job_launch-project-{{ test_id }}"
~d0.name = Launch a Job Template
~d1.job_launch = 
~d2.job_template = "Demo Job Template"
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Wait for a job template to complete
~d1.job_wait = 
~d2.job_id = "{{ result.id }}"
~d2.interval = 10
~d2.timeout = 120
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Check module fails with correct msg
~d1.job_launch = 
~d2.job_template = "Non_Existing_Job_Template"
~d2.inventory = "Demo Inventory"
~d1.register = result
~d1.ignore_errors = yes
~d0.assert = 
~d2.that = 
~d0.name = Create a Job Template for testing prompt on launch
~d1.job_template = 
~d2.name = "{{ jt_name1 }}"
~d2.project = Demo Project
~d2.playbook = hello_world.yml
~d2.job_type = run
~d2.ask_credential = true
~d2.ask_inventory = true
~d2.ask_tags_on_launch = true
~d2.ask_skip_tags_on_launch = true
~d2.state = present
~d1.register = result
~d0.name = Launch job template with inventory and credential for prompt on launch
~d1.job_launch = 
~d2.job_template = "{{ jt_name1 }}"
~d2.inventory = "Demo Inventory"
~d2.credential = "Demo Credential"
~d2.tags = 
~d2.skip_tags = 
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Create a project for testing extra_vars
~d1.project = 
~d2.name = "{{ proj_name }}"
~d2.organization = Default
~d2.scm_type = git
~d2.scm_url = https://github.com/ansible/test-playbooks
~d0.name = Create the job template with survey
~d1.job_template = 
~d2.name = "{{ jt_name2 }}"
~d2.project = "{{ proj_name }}"
~d2.playbook = debug.yml
~d2.job_type = run
~d2.state = present
~d2.inventory = "Demo Inventory"
~d2.survey_enabled = true
~d2.ask_variables_on_launch = false
~d2.survey_spec = 
~d3.name = ''
~d3.description = ''
~d3.spec = 
~d4.question_name = Basic Name
~d5.question_description = Name
~d5.required = true
~d5.type = text
~d5.variable = basic_name
~d5.min = 0
~d5.max = 1024
~d5.default = ''
~d5.choices = ''
~d5.new_question = true
~d4.question_name = Choose yes or no?
~d5.question_description = Choosing yes or no.
~d5.required = false
~d5.type = multiplechoice
~d5.variable = option_true_false
~d5.min = 
~d5.max = 
~d5.default = 'yes'
~d5.choices = |-
~d5.new_question = true
~d0.name = Kick off a job template with survey
~d1.job_launch = 
~d2.job_template = "{{ jt_name2 }}"
~d2.extra_vars = 
~d3.basic_name = My First Variable
~d3.option_true_false = 'no'
~d1.ignore_errors = yes
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Prompt the job templates extra_vars on launch
~d1.job_template = 
~d2.name = "{{ jt_name2 }}"
~d2.state = present
~d2.ask_variables_on_launch = true
~d0.name = Kick off a job template with extra_vars
~d1.job_launch = 
~d2.job_template = "{{ jt_name2 }}"
~d2.extra_vars = 
~d3.basic_name = My First Variable
~d3.var1 = My First Variable
~d3.var2 = My Second Variable
~d1.ignore_errors = yes
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Create a Job Template for testing extra_vars
~d1.job_template = 
~d2.name = "{{ jt_name2 }}"
~d2.project = "{{ proj_name }}"
~d2.playbook = debug.yml
~d2.job_type = run
~d2.survey_enabled = false
~d2.state = present
~d2.inventory = "Demo Inventory"
~d2.extra_vars = 
~d3.foo = bar
~d1.register = result
~d0.name = Launch job template with inventory and credential for prompt on launch
~d1.job_launch = 
~d2.job_template = "{{ jt_name2 }}"
~d2.organization = Default
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Wait for a job template to complete
~d1.job_wait = 
~d2.job_id = "{{ result.id }}"
~d2.interval = 10
~d2.timeout = 120
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Get the job
~d1.job_list = 
~d2.query = {"id": "{{result.id}}"}
~d1.register = result
~d0.assert = 
~d2.that = 
~d3.'{"foo" = "bar"} | to_json in result.results[0].extra_vars'
~d0.name = Delete the first jt
~d1.job_template = 
~d2.name = "{{ jt_name1 }}"
~d2.project = Demo Project
~d2.playbook = hello_world.yml
~d2.state = absent
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Delete the second jt
~d1.job_template = 
~d2.name = "{{ jt_name2 }}"
~d2.project = "{{ proj_name }}"
~d2.playbook = debug.yml
~d2.state = absent
~d1.register = result
~d0.assert = 
~d2.that = 
~d0.name = Delete the extra_vars project
~d1.project = 
~d2.name = "{{ proj_name }}"
~d2.organization = Default
~d2.state = absent
~d1.register = result
~d0.assert = 
~d2.that = 
